(()=>{var gt=Object.create;var Se=Object.defineProperty;var ct=Object.getOwnPropertyDescriptor;var ut=Object.getOwnPropertyNames;var ht=Object.getPrototypeOf,mt=Object.prototype.hasOwnProperty;var Ie=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),ft=(n,e)=>{for(var t in e)Se(n,t,{get:e[t],enumerable:!0})},pt=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ut(e))!mt.call(n,s)&&s!==t&&Se(n,s,{get:()=>e[s],enumerable:!(r=ct(e,s))||r.enumerable});return n};var T=(n,e,t)=>(t=n!=null?gt(ht(n)):{},pt(e||!n||!n.__esModule?Se(t,"default",{value:n,enumerable:!0}):t,n));var N=Ie((Xt,Ce)=>{Ce.exports=globalThis.msagl});var it=Ie(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});var We=class{constructor(...e){this._head=this._tail=null,this._length=0,e.length>0&&e.forEach(t=>{this.append(t)})}*iterator(){let e=this._head;for(;e;)yield e.value,e=e.next}[Symbol.iterator](){return this.iterator()}get head(){return this._head?this._head.value:null}get tail(){return this._tail?this._tail.value:null}get length(){return this._length}insert(e,t,r=!1){if(r&&this.isDuplicate(e))return!1;let s=new te(e),o=this._head;if(o)for(;;){if(o.value===t)return s.next=o.next,s.prev=o,o.next=s,s.next?s.next.prev=s:this._tail=s,this._length++,!0;if(o.next)o=o.next;else return!1}else return!1}append(e,t=!1){if(t&&this.isDuplicate(e))return!1;let r=new te(e);return this._tail?(this._tail.next=r,r.prev=this._tail,this._tail=r):this._head=this._tail=r,this._length++,!0}prepend(e,t=!1){if(t&&this.isDuplicate(e))return!1;let r=new te(e);return this._head?(r.next=this._head,this._head.prev=r,this._head=r):this._head=this._tail=r,this._length++,!0}remove(e){let t=this._head;if(!!t){if(t.value===e)return this._head=t.next,this._head.prev=null,t.next=t.prev=null,this._length--,t.value;for(;;){if(t.value===e)return t.next?(t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null):(t.prev.next=null,this._tail=t.prev,t.next=t.prev=null),this._length--,t.value;if(t.next)t=t.next;else return}}}removeHead(){let e=this._head;if(!!e)return this._head.next?(this._head.next.prev=null,this._head=this._head.next,e.next=e.prev=null):(this._head=null,this._tail=null),this._length--,e.value}removeTail(){let e=this._tail;if(!!e)return this._tail.prev?(this._tail.prev.next=null,this._tail=this._tail.prev,e.next=e.prev=null):(this._head=null,this._tail=null),this._length--,e.value}first(e){let t=this.iterator(),r=[],s=Math.min(e,this.length);for(let o=0;o<s;o++){let a=t.next();r.push(a.value)}return r}toArray(){return[...this]}isDuplicate(e){return new Set(this.toArray()).has(e)}};ye.LinkedList=We;var te=class{constructor(e){this.value=e,this.next=null,this.prev=null}};ye.LinkedListItem=te});var ot=Ie(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});var Wt=it(),Me=class extends Wt.LinkedList{constructor(...e){super(...e)}get front(){return this.head}enqueue(e){this.append(e)}dequeue(){return this.removeHead()}};Fe.Queue=Me});var Ue={};ft(Ue,{ArrowTypeEnum:()=>Y,Color:()=>i,DirTypeEnum:()=>Ge,DrawingEdge:()=>O,DrawingGraph:()=>ue,DrawingNode:()=>G,DrawingObject:()=>v,IncrementalDragger:()=>re,InsertionMode:()=>Ee,LayoutEditor:()=>I,ModifierKeysEnum:()=>ve,OrderingEnum:()=>xe,RankEnum:()=>De,ShapeEnum:()=>ne,StyleEnum:()=>ke,viewerObj:()=>D});var Y=(b=>(b[b.normal=0]="normal",b[b.inv=1]="inv",b[b.dot=2]="dot",b[b.invdot=3]="invdot",b[b.odot=4]="odot",b[b.invodot=5]="invodot",b[b.none=6]="none",b[b.tee=7]="tee",b[b.empty=8]="empty",b[b.invempty=9]="invempty",b[b.diamond=10]="diamond",b[b.odiamond=11]="odiamond",b[b.ediamond=12]="ediamond",b[b.crow=13]="crow",b[b.box=14]="box",b[b.obox=15]="obox",b[b.open=16]="open",b[b.halfopen=17]="halfopen",b[b.vee=18]="vee",b))(Y||{});var ne=(f=>(f[f.diamond=0]="diamond",f[f.ellipse=1]="ellipse",f[f.box=2]="box",f[f.circle=3]="circle",f[f.record=4]="record",f[f.plaintext=5]="plaintext",f[f.point=6]="point",f[f.mdiamond=7]="mdiamond",f[f.msquare=8]="msquare",f[f.polygon=9]="polygon",f[f.doublecircle=10]="doublecircle",f[f.house=11]="house",f[f.invhouse=12]="invhouse",f[f.parallelogram=13]="parallelogram",f[f.octagon=14]="octagon",f[f.tripleoctagon=15]="tripleoctagon",f[f.triangle=16]="triangle",f[f.trapezium=17]="trapezium",f[f.drawFromGeometry=18]="drawFromGeometry",f[f.hexagon=19]="hexagon",f))(ne||{});var De=(o=>(o[o.same=0]="same",o[o.min=1]="min",o[o.source=2]="source",o[o.max=3]="max",o[o.sink=4]="sink",o))(De||{});var ke=(c=>(c[c.none=0]="none",c[c.dashed=1]="dashed",c[c.solid=2]="solid",c[c.invis=3]="invis",c[c.bold=4]="bold",c[c.filled=5]="filled",c[c.diagonals=6]="diagonals",c[c.dotted=7]="dotted",c[c.rounded=8]="rounded",c))(ke||{});var Ge=(s=>(s[s.forward=0]="forward",s[s.back=1]="back",s[s.both=2]="both",s[s.none=3]="none",s))(Ge||{});var xe=(t=>(t[t.in=0]="in",t[t.out=1]="out",t))(xe||{});var i=class{static mkWithKeyword(e,t,r,s,o){let a=new i(e,t,r,s);return a.keyword=o,a}static parse(e){switch(e.toLowerCase()){case"aliceblue":return i.AliceBlue;case"antiquewhite":return i.AntiqueWhite;case"aqua":return i.Aqua;case"aquamarine":return i.Aquamarine;case"azure":return i.Azure;case"beige":return i.Beige;case"bisque":return i.Bisque;case"black":return i.Black;case"blanchedalmond":return i.BlanchedAlmond;case"blue":return i.Blue;case"blueviolet":return i.BlueViolet;case"brown":return i.Brown;case"burlywood":return i.BurlyWood;case"cadetblue":return i.CadetBlue;case"chartreuse":return i.Chartreuse;case"chocolate":return i.Chocolate;case"coral":return i.Coral;case"cornflowerblue":return i.CornflowerBlue;case"cornsilk":return i.Cornsilk;case"crimson":return i.Crimson;case"cyan":return i.Cyan;case"darkblue":return i.DarkBlue;case"darkcyan":return i.DarkCyan;case"darkgoldenrod":return i.DarkGoldenrod;case"darkgray":return i.DarkGray;case"darkgreen":return i.DarkGreen;case"darkkhaki":return i.DarkKhaki;case"darkmagenta":return i.DarkMagenta;case"darkolivegreen":return i.DarkOliveGreen;case"darkorange":return i.DarkOrange;case"darkorchid":return i.DarkOrchid;case"darkred":return i.DarkRed;case"darksalmon":return i.DarkSalmon;case"darkseagreen":return i.DarkSeaGreen;case"darkslateblue":return i.DarkSlateBlue;case"darkslategray":return i.DarkSlateGray;case"darkturquoise":return i.DarkTurquoise;case"darkviolet":return i.DarkViolet;case"deeppink":return i.DeepPink;case"deepskyblue":return i.DeepSkyBlue;case"dimgray":return i.DimGray;case"dodgerblue":return i.DodgerBlue;case"firebrick":return i.Firebrick;case"floralwhite":return i.FloralWhite;case"forestgreen":return i.ForestGreen;case"fuchsia":return i.Fuchsia;case"gainsboro":return i.Gainsboro;case"ghostwhite":return i.GhostWhite;case"gold":return i.Gold;case"goldenrod":return i.Goldenrod;case"gray":return i.Gray;case"green":return i.Green;case"greenyellow":return i.GreenYellow;case"honeydew":return i.Honeydew;case"hotpink":return i.HotPink;case"indianred":return i.IndianRed;case"indigo":return i.Indigo;case"ivory":return i.Ivory;case"khaki":return i.Khaki;case"lavender":return i.Lavender;case"lavenderblush":return i.LavenderBlush;case"lawngreen":return i.LawnGreen;case"lemonchiffon":return i.LemonChiffon;case"lightblue":return i.LightBlue;case"lightcoral":return i.LightCoral;case"lightcyan":return i.LightCyan;case"lightgoldenrodyellow":return i.LightGoldenrodYellow;case"lightgray":case"lightgrey":return i.LightGray;case"lightgreen":return i.LightGreen;case"lightpink":return i.LightPink;case"lightsalmon":return i.LightSalmon;case"lightseagreen":return i.LightSeaGreen;case"lightskyblue":return i.LightSkyBlue;case"lightslategray":return i.LightSlateGray;case"lightsteelblue":return i.LightSteelBlue;case"lightyellow":return i.LightYellow;case"lime":return i.Lime;case"limegreen":return i.LimeGreen;case"linen":return i.Linen;case"magenta":return i.Magenta;case"maroon":return i.Maroon;case"mediumaquamarine":return i.MediumAquamarine;case"mediumblue":return i.MediumBlue;case"mediumorchid":return i.MediumOrchid;case"mediumpurple":return i.MediumPurple;case"mediumseagreen":return i.MediumSeaGreen;case"mediumslateblue":return i.MediumSlateBlue;case"mediumspringgreen":return i.MediumSpringGreen;case"mediumturquoise":return i.MediumTurquoise;case"mediumvioletred":return i.MediumVioletRed;case"midnightblue":return i.MidnightBlue;case"mintcream":return i.MintCream;case"mistyrose":return i.MistyRose;case"moccasin":return i.Moccasin;case"navajowhite":return i.NavajoWhite;case"navy":return i.Navy;case"oldlace":return i.OldLace;case"olive":return i.Olive;case"olivedrab":return i.OliveDrab;case"orange":return i.Orange;case"orangered":return i.OrangeRed;case"orchid":return i.Orchid;case"palegoldenrod":return i.PaleGoldenrod;case"palegreen":return i.PaleGreen;case"paleturquoise":return i.PaleTurquoise;case"palevioletred":return i.PaleVioletRed;case"papayawhip":return i.PapayaWhip;case"peachpuff":return i.PeachPuff;case"peru":return i.Peru;case"pink":return i.Pink;case"plum":return i.Plum;case"powderblue":return i.PowderBlue;case"purple":return i.Purple;case"red":return i.Red;case"rosybrown":return i.RosyBrown;case"royalblue":return i.RoyalBlue;case"saddlebrown":return i.SaddleBrown;case"salmon":return i.Salmon;case"sandybrown":return i.SandyBrown;case"seagreen":return i.SeaGreen;case"seashell":return i.SeaShell;case"sienna":return i.Sienna;case"silver":return i.Silver;case"skyblue":return i.SkyBlue;case"slateblue":return i.SlateBlue;case"slategray":return i.SlateGray;case"snow":return i.Snow;case"springgreen":return i.SpringGreen;case"steelblue":return i.SteelBlue;case"tan":return i.Tan;case"teal":return i.Teal;case"thistle":return i.Thistle;case"tomato":return i.Tomato;case"transparent":return i.Transparent;case"turquoise":return i.Turquoise;case"violet":return i.Violet;case"wheat":return i.Wheat;case"white":return i.White;case"whitesmoke":return i.WhiteSmoke;case"yellow":return i.Yellow;case"yellowgreen":return i.YellowGreen;default:return}}get keyword(){return this.keyword_}set keyword(e){this.keyword_=e}constructor(e,t,r,s){this.a=e,this.r=t,this.g=r,this.b=s}static mkRGB(e,t,r){return new i(255,e,t,r)}get A(){return this.a}set A(e){this.a=e}get R(){return this.r}set R(e){this.r=e}get G(){return this.g}set G(e){this.g=e}get B(){return this.b}set B(e){this.b=e}static Xex(e){let t=e.toString(16);return t.length===1?"0"+t:t.substring(t.length-2,2)}static equal(e,t){return e.a===t.a&&e.r===t.r&&e.b===t.b&&e.g===t.g}toString(){return this.keyword?this.keyword:'"#'+i.Xex(this.R)+i.Xex(this.G)+i.Xex(this.B)+(this.A===255?"":i.Xex(this.A))+'"'}static get AliceBlue(){return i.mkWithKeyword(255,240,248,255,"aliceblue")}static get AntiqueWhite(){return i.mkWithKeyword(255,250,235,215,"antiquewhite")}static get Aqua(){return i.mkWithKeyword(255,0,255,255,"aqua")}static get Aquamarine(){return i.mkWithKeyword(255,127,255,212,"aquamarine")}static get Azure(){return i.mkWithKeyword(255,240,255,255,"azure")}static get Beige(){return i.mkWithKeyword(255,245,245,220,"beige")}static get Bisque(){return i.mkWithKeyword(255,255,228,196,"bisque")}static get Black(){return i.mkWithKeyword(255,0,0,0,"black")}static get BlanchedAlmond(){return i.mkWithKeyword(255,255,235,205,"blanchedalmond")}static get Blue(){return i.mkWithKeyword(255,0,0,255,"blue")}static get BlueViolet(){return i.mkWithKeyword(255,138,43,226,"blueviolet")}static get Brown(){return i.mkWithKeyword(255,165,42,42,"brown")}static get BurlyWood(){return i.mkWithKeyword(255,222,184,135,"burlywood")}static get CadetBlue(){return i.mkWithKeyword(255,95,158,160,"cadetblue")}static get Chartreuse(){return i.mkWithKeyword(255,127,255,0,"chartreuse")}static get Chocolate(){return i.mkWithKeyword(255,210,105,30,"chocolate")}static get Coral(){return i.mkWithKeyword(255,255,127,80,"coral")}static get CornflowerBlue(){return i.mkWithKeyword(255,100,149,237,"cornflowerblue")}static get Cornsilk(){return i.mkWithKeyword(255,255,248,220,"cornsilk")}static get Crimson(){return i.mkWithKeyword(255,220,20,60,"crimson")}static get Cyan(){return i.mkWithKeyword(255,0,255,255,"cyan")}static get DarkBlue(){return i.mkWithKeyword(255,0,0,139,"darkblue")}static get DarkCyan(){return i.mkWithKeyword(255,0,139,139,"darkcyan")}static get DarkGoldenrod(){return i.mkWithKeyword(255,184,134,11,"darkgoldenrod")}static get DarkGray(){return i.mkWithKeyword(255,169,169,169,"darkgray")}static get DarkGreen(){return i.mkWithKeyword(255,0,100,0,"darkgreen")}static get DarkKhaki(){return i.mkWithKeyword(255,189,183,107,"darkkhaki")}static get DarkMagenta(){return i.mkWithKeyword(255,139,0,139,"darkmagenta")}static get DarkOliveGreen(){return i.mkWithKeyword(255,85,107,47,"darkolivegreen")}static get DarkOrange(){return i.mkWithKeyword(255,255,140,0,"darkorange")}static get DarkOrchid(){return i.mkWithKeyword(255,153,50,204,"darkorchid")}static get DarkRed(){return i.mkWithKeyword(255,139,0,0,"darkred")}static get DarkSalmon(){return i.mkWithKeyword(255,233,150,122,"darksalmon")}static get DarkSeaGreen(){return i.mkWithKeyword(255,143,188,139,"darkseagreen")}static get DarkSlateBlue(){return i.mkWithKeyword(255,72,61,139,"darkslateblue")}static get DarkSlateGray(){return i.mkWithKeyword(255,47,79,79,"darkslategray")}static get DarkTurquoise(){return i.mkWithKeyword(255,0,206,209,"darkturquoise")}static get DarkViolet(){return i.mkWithKeyword(255,148,0,211,"darkviolet")}static get DeepPink(){return i.mkWithKeyword(255,255,20,147,"deeppink")}static get DeepSkyBlue(){return i.mkWithKeyword(255,0,191,255,"deepskyblue")}static get DimGray(){return i.mkWithKeyword(255,105,105,105,"dimgray")}static get DodgerBlue(){return i.mkWithKeyword(255,30,144,255,"dodgerblue")}static get Firebrick(){return i.mkWithKeyword(255,178,34,34,"firebrick")}static get FloralWhite(){return i.mkWithKeyword(255,255,250,240,"floralwhite")}static get ForestGreen(){return i.mkWithKeyword(255,34,139,34,"forestgreen")}static get Fuchsia(){return i.mkWithKeyword(255,255,0,255,"fuchsia")}static get Gainsboro(){return i.mkWithKeyword(255,220,220,220,"gainsboro")}static get GhostWhite(){return i.mkWithKeyword(255,248,248,255,"ghostwhite")}static get Gold(){return i.mkWithKeyword(255,255,215,0,"gold")}static get Goldenrod(){return i.mkWithKeyword(255,218,165,32,"goldenrod")}static get Gray(){return i.mkWithKeyword(255,128,128,128,"gray")}static get Green(){return i.mkWithKeyword(255,0,128,0,"green")}static get GreenYellow(){return i.mkWithKeyword(255,173,255,47,"greenyellow")}static get Honeydew(){return i.mkWithKeyword(255,240,255,240,"honeydew")}static get HotPink(){return i.mkWithKeyword(255,255,105,180,"hotpink")}static get IndianRed(){return i.mkWithKeyword(255,205,92,92,"indianred")}static get Indigo(){return i.mkWithKeyword(255,75,0,130,"indigo")}static get Ivory(){return i.mkWithKeyword(255,255,255,240,"ivory")}static get Khaki(){return i.mkWithKeyword(255,240,230,140,"khaki")}static get Lavender(){return i.mkWithKeyword(255,230,230,250,"lavender")}static get LavenderBlush(){return i.mkWithKeyword(255,255,240,245,"lavenderblush")}static get LawnGreen(){return i.mkWithKeyword(255,124,252,0,"lawngreen")}static get LemonChiffon(){return i.mkWithKeyword(255,255,250,205,"lemonchiffon")}static get LightBlue(){return i.mkWithKeyword(255,173,216,230,"lightblue")}static get LightCoral(){return i.mkWithKeyword(255,240,128,128,"lightcoral")}static get LightCyan(){return i.mkWithKeyword(255,224,255,255,"lightcyan")}static get LightGoldenrodYellow(){return i.mkWithKeyword(255,250,250,210,"lightgoldenrodyellow")}static get LightGray(){return i.mkWithKeyword(255,211,211,211,"lightgray")}static get LightGreen(){return i.mkWithKeyword(255,144,238,144,"lightgreen")}static get LightPink(){return i.mkWithKeyword(255,255,182,193,"lightpink")}static get LightSalmon(){return i.mkWithKeyword(255,255,160,122,"lightsalmon")}static get LightSeaGreen(){return i.mkWithKeyword(255,32,178,170,"lightseagreen")}static get LightSkyBlue(){return i.mkWithKeyword(255,135,206,250,"lightskyblue")}static get LightSlateGray(){return i.mkWithKeyword(255,119,136,153,"lightslategray")}static get LightSteelBlue(){return i.mkWithKeyword(255,176,196,222,"lightsteelblue")}static get LightYellow(){return i.mkWithKeyword(255,255,255,224,"lightyellow")}static get Lime(){return i.mkWithKeyword(255,0,255,0,"lime")}static get LimeGreen(){return i.mkWithKeyword(255,50,205,50,"limegreen")}static get Linen(){return i.mkWithKeyword(255,250,240,230,"linen")}static get Magenta(){return i.mkWithKeyword(255,255,0,255,"magenta")}static get Maroon(){return i.mkWithKeyword(255,128,0,0,"maroon")}static get MediumAquamarine(){return i.mkWithKeyword(255,102,205,170,"mediumaquamarine")}static get MediumBlue(){return i.mkWithKeyword(255,0,0,205,"mediumblue")}static get MediumOrchid(){return i.mkWithKeyword(255,186,85,211,"mediumorchid")}static get MediumPurple(){return i.mkWithKeyword(255,147,112,219,"mediumpurple")}static get MediumSeaGreen(){return i.mkWithKeyword(255,60,179,113,"mediumseagreen")}static get MediumSlateBlue(){return i.mkWithKeyword(255,123,104,238,"mediumslateblue")}static get MediumSpringGreen(){return i.mkWithKeyword(255,0,250,154,"mediumspringgreen")}static get MediumTurquoise(){return i.mkWithKeyword(255,72,209,204,"mediumturquoise")}static get MediumVioletRed(){return i.mkWithKeyword(255,199,21,133,"mediumvioletred")}static get MidnightBlue(){return i.mkWithKeyword(255,25,25,112,"midnightblue")}static get MintCream(){return i.mkWithKeyword(255,245,255,250,"mintcream")}static get MistyRose(){return i.mkWithKeyword(255,255,228,225,"mistyrose")}static get Moccasin(){return i.mkWithKeyword(255,255,228,181,"moccasin")}static get NavajoWhite(){return i.mkWithKeyword(255,255,222,173,"navajowhite")}static get Navy(){return i.mkWithKeyword(255,0,0,128,"navy")}static get OldLace(){return i.mkWithKeyword(255,253,245,230,"oldlace")}static get Olive(){return i.mkWithKeyword(255,128,128,0,"olive")}static get OliveDrab(){return i.mkWithKeyword(255,107,142,35,"olivedrab")}static get Orange(){return i.mkWithKeyword(255,255,165,0,"orange")}static get OrangeRed(){return i.mkWithKeyword(255,255,69,0,"orangered")}static get Orchid(){return i.mkWithKeyword(255,218,112,214,"orchid")}static get PaleGoldenrod(){return i.mkWithKeyword(255,238,232,170,"palegoldenrod")}static get PaleGreen(){return i.mkWithKeyword(255,152,251,152,"palegreen")}static get PaleTurquoise(){return i.mkWithKeyword(255,175,238,238,"paleturquoise")}static get PaleVioletRed(){return i.mkWithKeyword(255,219,112,147,"palevioletred")}static get PapayaWhip(){return i.mkWithKeyword(255,255,239,213,"papayawhip")}static get PeachPuff(){return i.mkWithKeyword(255,255,218,185,"peachpuff")}static get Peru(){return i.mkWithKeyword(255,205,133,63,"peru")}static get Pink(){return i.mkWithKeyword(255,255,192,203,"pink")}static get Plum(){return i.mkWithKeyword(255,221,160,221,"plum")}static get PowderBlue(){return i.mkWithKeyword(255,176,224,230,"powderblue")}static get Purple(){return i.mkWithKeyword(255,128,0,128,"purple")}static get Red(){return i.mkWithKeyword(255,255,0,0,"red")}static get RosyBrown(){return i.mkWithKeyword(255,188,143,143,"rosybrown")}static get RoyalBlue(){return i.mkWithKeyword(255,65,105,225,"royalblue")}static get SaddleBrown(){return i.mkWithKeyword(255,139,69,19,"saddlebrown")}static get Salmon(){return i.mkWithKeyword(255,250,128,114,"salmon")}static get SandyBrown(){return i.mkWithKeyword(255,244,164,96,"sandybrown")}static get SeaGreen(){return i.mkWithKeyword(255,46,139,87,"seagreen")}static get SeaShell(){return i.mkWithKeyword(255,255,245,238,"seashell")}static get Sienna(){return i.mkWithKeyword(255,160,82,45,"sienna")}static get Silver(){return i.mkWithKeyword(255,192,192,192,"silver")}static get SkyBlue(){return i.mkWithKeyword(255,135,206,235,"skyblue")}static get SlateBlue(){return i.mkWithKeyword(255,106,90,205,"slateblue")}static get SlateGray(){return i.mkWithKeyword(255,112,128,144,"slategray")}static get Snow(){return i.mkWithKeyword(255,255,250,250,"snow")}static get SpringGreen(){return i.mkWithKeyword(255,0,255,127,"springgreen")}static get SteelBlue(){return i.mkWithKeyword(255,70,130,180,"steelblue")}static get Tan(){return i.mkWithKeyword(255,210,180,140,"tan")}static get Teal(){return i.mkWithKeyword(255,0,128,128,"teal")}static get Thistle(){return i.mkWithKeyword(255,216,191,216,"thistle")}static get Tomato(){return i.mkWithKeyword(255,255,99,71,"tomato")}static get Transparent(){return i.mkWithKeyword(0,255,255,255,"transparent")}static get Turquoise(){return i.mkWithKeyword(255,64,224,208,"turquoise")}static get Violet(){return i.mkWithKeyword(255,238,130,238,"violet")}static get Wheat(){return i.mkWithKeyword(255,245,222,179,"wheat")}static get White(){return i.mkWithKeyword(255,255,255,255,"white")}static get WhiteSmoke(){return i.mkWithKeyword(255,245,245,245,"whitesmoke")}static get Yellow(){return i.mkWithKeyword(255,255,255,0,"yellow")}static get YellowGreen(){return i.mkWithKeyword(255,154,205,50,"yellowgreen")}};var p=T(N(),1);var $=T(N(),1),Z=class extends $.Attribute{constructor(t){super(t,$.AttributeRegistry.DrawingObjectIndex);this.labelfontcolor=i.Black;this.styles=[];this.penwidth=1;this.fontname=Z.defaultLabelFontName,this.fontsize=Z.defaultLabelFontSize}rebind(t){this.entity=t,this.bind($.AttributeRegistry.DrawingObjectIndex)}static copyValidFields(t,r){t==null||r==null||(t.color&&t.color.keyword&&t.color.keyword.toLowerCase()!=="black"&&(r.color=t.color),t.fillColor&&(r.fillColor=t.fillColor),t.labelfontcolor&&t.labelfontcolor.keyword.toLowerCase()!=="black"&&(r.labelfontcolor=t.labelfontcolor),t.labelText!=null&&t.labelText!==""&&t.labelText!==t.id&&(r.labelText=t.labelText),t.fontColor&&t.fontColor.keyword&&t.fontColor.keyword.toLowerCase()!=="black"&&(r.fontColor=t.fontColor),t.styles&&t.styles.length&&(r.styles=t.styles.map(s=>s)),t.pencolor&&t.pencolor.keyword!=="black"&&(r.pencolor=t.pencolor),t.penwidth&&t.penwidth!==1&&(r.penwidth=t.penwidth),t.rankdir&&(r.rankdir=t.rankdir),t.fontname&&t.fontname!==Z.defaultLabelFontName&&(r.fontname=t.fontname),t.margin&&(r.margin=t.margin),t.fontsize&&t.fontsize!==Z.defaultLabelFontSize&&(r.fontsize=t.fontsize),t.orientation&&(r.orientation=t.orientation),t.ranksep&&(r.ranksep=t.ranksep),t.arrowtail&&(r.arrowtail=t.arrowtail),t.arrowhead&&(r.arrowhead=t.arrowhead),t.ordering&&(r.ordering=t.ordering),t.bgcolor&&(r.bgcolor=t.bgcolor),t.pos&&(r.pos=t.pos),t.nodesep&&(r.nodesep=t.nodesep),t.arrowsize&&(r.arrowsize=t.arrowsize),t.samehead&&(r.samehead=t.samehead),t.layersep&&(r.layersep=t.layersep),t.clusterRank&&(r.clusterRank=t.clusterRank))}get labelText(){return this._labelText}set labelText(t){this._labelText=t}get arrowhead(){return this._arrowhead}set arrowhead(t){this._arrowhead=t}get id(){return this._id}set id(t){this._id=t}static getDrawingObj(t){return t==null?null:t.getAttr($.AttributeRegistry.DrawingObjectIndex)}},v=Z;v.defaultLabelFontName="Times-Roman",v.defaultLabelFontSize=12;var ce=class extends v{constructor(t){super(t);this.shape=2;this.padding=2;this.xRad=3;this.yRad=3;this.labelMargin=1;this.labelWidthToHeightRatio=1;t!=null&&(this.labelText=t.id)}clone(){throw new Error("Method not implemented.")}get Padding(){return this.padding}set Padding(t){this.padding=Math.max(0,t)}get XRadius(){return this.xRad}set XRadius(t){this.xRad=t}get YRadius(){return this.yRad}set YRadius(t){this.yRad=t}static get DefaultFillColor(){return ce.defaultFillColor}static set DefaultFillColor(t){ce.defaultFillColor=t}get ShapeEnum(){return this.shape}set ShapeEnum(t){this.shape=t}get LabelMargin(){return this.labelMargin}set LabelMargin(t){this.labelMargin=t}get LabelWidthToHeightRatio(){return this.labelWidthToHeightRatio}set LabelWidthToHeightRatio(t){this.labelWidthToHeightRatio=t}get node(){return this.entity}get id(){return this.node?this.node.id:""}},G=ce;G.defaultFillColor=i.LightGray;var O=class extends v{constructor(t,r){super(t);this.directed=!0;this.directed=r,r?this.arrowhead=0:this.arrowhead=6,this.arrowtail=6}clone(){let t=new O(null,this.directed);return v.copyValidFields(this,t),t.directed=this.directed,t.arrowtail=this.arrowtail,t.arrowhead=this.arrowhead,t}};var ue=class extends G{constructor(){super(...arguments);this.graphVisData={sameRanks:new Array,minRanks:new Array,maxRanks:new Array,sourceRanks:new Array,sinkRanks:new Array}}get defaultNodeObject(){return this._defaultNodeObject}set defaultNodeObject(t){this._defaultNodeObject=t}static getDrawingGraph(t){return v.getDrawingObj(t)}get graph(){return this.entity}findNode(t){let s=this.graph.findNode(t);return s==null?null:v.getDrawingObj(s)}hasDirectedEdge(){for(let t of this.graph.deepEdges)if(v.getDrawingObj(t).directed)return!0;return!1}createGeometry(t=r=>r?new p.Size(r.length*8+8,20):null){let r=new p.GeomGraph(this.graph);this.textMeasure=t;let s={fontFamily:this.fontname,fontSize:this.fontsize,fontStyle:"normal"};r.labelSize=t(this.labelText,s);for(let o of this.graph.nodesBreadthFirst)this.createNodeGeometry(o);for(let o of this.graph.deepEdges)this.createEdgeGeometry(o);if(this.rankdir){let o=r.layoutSettings=new p.SugiyamaLayoutSettings;o.layerDirection=this.rankdir}return r}createEdgeGeometry(t){let r=O.getDrawingObj(t),s=new p.GeomEdge(t);if(r.arrowhead!=6&&(s.targetArrowhead=new p.Arrowhead),r.arrowtail!=6&&(s.sourceArrowhead=new p.Arrowhead),r.labelText){let o=this.textMeasure(r.labelText,{fontSize:r.fontsize,fontFamily:r.fontname,fontStyle:"normal"}),a=t.label=new p.Label(t);new p.GeomLabel(a,p.Rectangle.mkPP(new p.Point(0,0),new p.Point(o.width,o.height))),r.measuredTextSize=o}r.penwidth&&(s.lineWidth=r.penwidth)}curveByShape(t,r,s,o){let a;switch(o.shape){case 0:a=p.CurveFactory.mkDiamond(t,r,s);break;case 1:a=p.CurveFactory.mkEllipse(t/1.6,r/1.6,s);break;case 4:case 2:a=p.CurveFactory.mkRectangleWithRoundedCorners(t,r,o.XRadius,o.YRadius,s);break;case 3:a=p.CurveFactory.mkCircle(Math.sqrt(t*t+r*r),s);break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:a=p.CurveFactory.mkCircle(Math.sqrt(t*t+r*r)+2*o.penwidth,s);break;case 11:a=p.CurveFactory.createHouse(t,r,s);break;case 12:a=p.CurveFactory.createInvertedHouse(t,r,s);break;case 13:a=p.CurveFactory.createParallelogram(t,r,s);break;case 14:a=p.CurveFactory.createOctagon(t,r,s);break;case 15:break;case 16:break;case 17:break;case 18:break;case 19:a=p.CurveFactory.createHexagon(t,r,s);break}return a!=null?a:p.CurveFactory.mkRectangleWithRoundedCorners(t,r,o.XRadius,o.YRadius,s)}createNodeGeometry(t,r=new p.Point(0,0)){if(t instanceof p.Graph){let s=v.getDrawingObj(t),o=new p.GeomGraph(t);s.labelText&&(o.labelSize=s.measuredTextSize=Oe(s,this.textMeasure))}else{let s=G.getDrawingObj(t),o=new p.Size(1,1);s.labelText&&(o=Oe(s,this.textMeasure)),s.measuredTextSize=o;let a=new p.GeomNode(t),l=o.width+s.LabelMargin*2,g=o.height+s.LabelMargin*2;a.boundaryCurve=this.curveByShape(l,g,r,s)}}measureLabelSizes(t){var r;for(let s of this.graph.nodesBreadthFirst){let o=G.getDrawingObj(s);o.measuredTextSize=(r=Oe(o,t))!=null?r:new p.Size(1,1)}}};function Oe(n,e){return n.labelText?e(n.labelText,{fontSize:n.fontsize,fontFamily:n.fontname,fontStyle:"normal"}):null}var d=T(N(),1);var Q;(function(n){n.has=Symbol.for("@esfx/collection-core!ReadonlyCollection.has"),n.name="ReadonlyContainer";function e(t){return(typeof t=="object"&&t!==null||typeof t=="function")&&n.has in t}n.hasInstance=e})(Q||(Q={}));var ie;(function(n){n.has=Q.has,n.add=Symbol.for("@esfx/collection-core!Collection.add"),n.delete=Symbol.for("@esfx/collection-core!Collection.delete"),n.name="Container";function e(t){return Q.hasInstance(t)&&n.add in t&&n.delete in t}n.hasInstance=e})(ie||(ie={}));var x;(function(n){n.has=Q.has,n.size=Symbol.for("@esfx/collection-core!ReadonlyCollection.size"),n.name="ReadonlyCollection";function e(t){return Q.hasInstance(t)&&(typeof t=="object"&&t!==null||typeof t=="function")&&Symbol.iterator in t&&n.size in t}n.hasInstance=e})(x||(x={}));var oe;(function(n){n.size=x.size,n.has=x.has,n.add=ie.add,n.delete=ie.delete,n.clear=Symbol.for("@esfx/collection-core!Collection.clear"),n.name="Collection";function e(t){return x.hasInstance(t)&&ie.hasInstance(t)&&n.clear in t}n.hasInstance=e})(oe||(oe={}));var V;(function(n){n.size=x.size,n.has=x.has,n.indexOf=Symbol.for("@esfx/collection-core!ReadonlyIndexedCollection.indexOf"),n.getAt=Symbol.for("@esfx/collection-core!ReadonlyIndexedCollection.getAt"),n.name="ReadonlyIndexedCollection";function e(t){return x.hasInstance(t)&&n.indexOf in t&&n.getAt in t}n.hasInstance=e})(V||(V={}));var he;(function(n){n.size=x.size,n.has=x.has,n.indexOf=V.indexOf,n.getAt=V.getAt,n.setAt=Symbol.for("@esfx/collection-core!FixedSizeIndexedCollection.setAt"),n.name="FixedSizeIndexedCollection";function e(t){return V.hasInstance(t)&&n.setAt in t}n.hasInstance=e})(he||(he={}));var Ve;(function(n){n.size=x.size,n.has=x.has,n.indexOf=V.indexOf,n.getAt=V.getAt,n.setAt=he.setAt,n.add=oe.add,n.delete=oe.delete,n.clear=oe.clear,n.insertAt=Symbol.for("@esfx/collection-core!IndexedCollection.insertAt"),n.removeAt=Symbol.for("@esfx/collection-core!IndexedCollection.removeAt"),n.name="IndexedCollection";function e(t){return he.hasInstance(t)&&n.insertAt in t&&n.removeAt in t}n.hasInstance=e})(Ve||(Ve={}));var L;(function(n){n.has=Symbol.for("@esfx/collection-core!ReadonlyKeyedContainer.has"),n.get=Symbol.for("@esfx/collection-core!ReadonlyKeyedContainer.get"),n.name="ReadonlyKeyedContainer";function e(t){return(typeof t=="object"&&t!==null||typeof t=="function")&&n.has in t&&n.get in t}n.hasInstance=e})(L||(L={}));var se;(function(n){n.has=L.has,n.get=L.get,n.set=Symbol.for("@esfx/collection-core!KeyedCollection.set"),n.delete=Symbol.for("@esfx/collection-core!KeyedCollection.delete"),n.name="KeyedContainer";function e(t){return L.hasInstance(t)&&n.set in t&&n.delete in t}n.hasInstance=e})(se||(se={}));var F;(function(n){n.has=L.has,n.get=L.get,n.size=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.size"),n.keys=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.keys"),n.values=Symbol.for("@esfx/collection-core!ReadonlyKeyedCollection.values"),n.name="ReadonlyKeyedCollection";function e(t){return(typeof t=="object"&&t!==null||typeof t=="function")&&Symbol.iterator in t&&L.hasInstance(t)&&n.size in t&&n.keys in t&&n.values in t}n.hasInstance=e})(F||(F={}));var R;(function(n){n.size=F.size,n.has=F.has,n.get=F.get,n.keys=F.keys,n.values=F.values,n.set=se.set,n.delete=se.delete,n.clear=Symbol.for("@esfx/collection-core!KeyedCollection.clear"),n.name="KeyedCollection";function e(t){return F.hasInstance(t)&&se.hasInstance(t)&&n.clear in t}n.hasInstance=e})(R||(R={}));var A;(function(n){n.size=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.size"),n.has=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.has"),n.hasValue=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.hasValue"),n.get=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.get"),n.keys=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.keys"),n.values=Symbol.for("@esfx/collection-core!ReadonlyKeyedMultiCollection.values"),n.name="ReadonlyKeyedMultiCollection";function e(t){return(typeof t=="object"&&t!==null||typeof t=="function")&&Symbol.iterator in t&&n.size in t&&n.has in t&&n.hasValue in t&&n.get in t&&n.keys in t&&n.values in t}n.hasInstance=e})(A||(A={}));var Ke;(function(n){n.size=A.size,n.has=A.has,n.hasValue=A.hasValue,n.get=A.get,n.keys=A.keys,n.values=A.values,n.add=Symbol.for("@esfx/collection-core!KeyedMultiCollection.add"),n.delete=Symbol.for("@esfx/collection-core!KeyedMultiCollection.delete"),n.deleteValue=Symbol.for("@esfx/collection-core!KeyedMultiCollection.deleteValue"),n.clear=Symbol.for("@esfx/collection-core!KeyedMultiCollection.clear"),n.name="KeyedMultiCollection";function e(t){return A.hasInstance(t)&&n.add in t&&n.delete in t&&n.deleteValue in t&&n.clear in t}n.hasInstance=e})(Ke||(Ke={}));function qe(n,e,t,r){if(e%4)throw new TypeError("Pointer not aligned");let s=new Uint32Array(n),o,a,l,g,c,m,u;if(a=e+t,e>>=2,t>=16){l=a-16>>2,g=(r+2654435761|0)+2246822519|0,c=r+2246822519|0,m=r+0|0,u=r+2654435761|0;do g=g+s[e++]*2246822519|0|0,g=(g<<13|g>>>19)*2654435761|0,c=c+s[e++]*2246822519|0|0,c=(c<<13|c>>>19)*2654435761|0,m=m+s[e++]*2246822519|0|0,m=(m<<13|m>>>19)*2654435761|0,u=u+s[e++]*2246822519|0|0,u=(u<<13|u>>>19)*2654435761|0;while(e<=l);o=(g<<1|g>>>31)+(c<<7|c>>>25)|(m<<12|m>>>20)|(u<<18|u>>>14)}else o=r+374761393|0;for(o=o+t|0,l=a-4>>2;e<=l;)o=o+s[e++]*3266489917|0|0,o=(o<<17|o>>>15)*668265263|0;if(e=e<<2,e<a){let y=new Uint8Array(s.buffer);do o=o+y[e++]*374761393|0|0,o=(o<<11|o>>>21)*2654435761|0;while(e<a)}return o=(o^o>>>15)*2246822519|0,o=(o^o>>>13)*3266489917|0,o=o^o>>>16,o>>>0}var wt=typeof WebAssembly<"u"&&typeof WebAssembly.Module=="function"&&typeof WebAssembly.Instance=="function",Pt=new Uint8Array([0,97,115,109,1,0,0,0,1,8,1,96,3,127,127,126,1,126,3,2,1,0,5,3,1,0,1,7,15,2,3,109,101,109,2,0,5,120,120,104,54,52,0,0,10,130,6,1,255,5,2,3,126,1,127,32,0,32,1,106,33,6,32,1,65,32,79,4,126,32,6,65,32,107,33,6,32,2,66,214,235,130,238,234,253,137,245,224,0,124,33,3,32,2,66,177,169,172,193,173,184,212,166,61,125,33,4,32,2,66,249,234,208,208,231,201,161,228,225,0,124,33,5,3,64,32,3,32,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,3,32,4,32,0,65,8,106,34,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,4,32,2,32,0,65,8,106,34,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,2,32,5,32,0,65,8,106,34,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,5,32,6,32,0,65,8,106,34,0,79,13,0,11,32,2,66,12,137,32,5,66,18,137,124,32,4,66,7,137,124,32,3,66,1,137,124,32,3,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,32,4,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,32,2,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,32,5,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,5,32,2,66,197,207,217,178,241,229,186,234,39,124,11,32,1,173,124,33,2,32,0,32,1,65,31,113,106,33,1,3,64,32,1,32,0,65,8,106,79,4,64,32,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,32,2,133,66,27,137,66,135,149,175,175,152,182,222,155,158,127,126,66,157,163,181,234,131,177,141,138,250,0,125,33,2,32,0,65,8,106,33,0,12,1,11,11,32,0,65,4,106,32,1,77,4,64,32,2,32,0,53,2,0,66,135,149,175,175,152,182,222,155,158,127,126,133,66,23,137,66,207,214,211,190,210,199,171,217,66,126,66,249,243,221,241,153,246,153,171,22,124,33,2,32,0,65,4,106,33,0,11,3,64,32,0,32,1,73,4,64,32,2,32,0,49,0,0,66,197,207,217,178,241,229,186,234,39,126,133,66,11,137,66,135,149,175,175,152,182,222,155,158,127,126,33,2,32,0,65,1,106,33,0,12,1,11,11,32,2,32,2,66,33,136,133,66,207,214,211,190,210,199,171,217,66,126,34,2,66,29,136,32,2,133,66,249,243,221,241,153,246,153,171,22,126,34,2,66,32,136,32,2,133,11]),K=wt?new WebAssembly.Instance(new WebAssembly.Module(Pt)).exports:void 0;var q=K===null||K===void 0?void 0:K.mem,Re=K===null||K===void 0?void 0:K.xxh64;var St=typeof TextEncoder=="function",ze=(n,e)=>(ze=It())(n,e),Te=(n,e)=>ze(n,e);function It(){function n(){let t=new TextEncoder;function r(s,o){let{written:a=0}=t.encodeInto(s,o);return a}return r}function e(){function t(r,s){let o=r.length,a=0;for(let l=0;l<o;l++){let g=r.charCodeAt(l);if((g&55296)!==0&&(g&4294910976)===0&&l<o-1){let c=r.charCodeAt(l+1);(c&64512)===56320&&(g=((g&1023)<<10)+(c&1023)+65536,l++)}if((g&4294967168)===0)s[a++]=g;else if((g&4294965248)===0)s[a++]=g>>6|192,s[a++]=g&63|128;else if((g&268431360)===0)s[a++]=g>>12|224,s[a++]=g>>6&63|128,s[a++]=g&63|128;else if((g&4292870144)===0)s[a++]=g>>18|240,s[a++]=g>>12&63|128,s[a++]=g>>6&63|128,s[a++]=g&63|128;else throw new RangeError("Unsupported charCode.")}return a}return t}return St?n():e()}var Ne=typeof BigInt=="function"&&typeof BigInt(0)=="bigint",He=typeof BigUint64Array=="function",kt=typeof q=="object"&&typeof Re=="function",je=new ArrayBuffer(8),Gt=new Float64Array(je),B=new Uint32Array(je),J=()=>(J=xt())(),Xe=n=>(Xe=Ot())(n),Ye=n=>(Ye=Rt())(n),Ze=n=>(Ze=J())(n),$e=n=>($e=Tt())(n),Qe=n=>(Qe=Nt())(n),Je=n=>Xe(n),_e=n=>Ye(n),et=n=>Ze(n),tt=n=>$e(n),Ae=n=>Qe(n);function xt(){function n(){let t=new BigUint64Array(B.buffer),r=new Uint8Array(q.buffer);function s(c){q.buffer.byteLength<c&&(q.grow(Math.ceil((c-q.buffer.byteLength)/65536)),r=new Uint8Array(q.buffer))}function o(c){t[0]=c;let m=B[0],u=B[1];return(m<<7|m>>>25)^u}function a(){return B[0]=me(),B[1]=me(),t[0]}function l(c,m){s(c.length*3);let u=Te(c,r);return o(Re(0,u,m))}function g(){let c=a();function m(u){return l(u,c)}return m}return g}function e(){let t=new Uint8Array(65536);function r(a){t.byteLength<a&&(t=new Uint8Array(a+(65536-a%65536)))}function s(a,l){r(a.length*3);let g=Te(a,t);return qe(t.buffer,0,g,l)>>0}function o(){let a=me();function l(g){return s(g,a)}return l}return o}return Ne&&He&&kt?n():e()}function Ot(){function n(t){Gt[0]=t;let r=B[0],s=B[1];return(r<<7|r>>>25)^s|0}function e(t){return t>>0===t?t|0:n(t)}return e}function Rt(){function n(){let r=new BigUint64Array(je),s=BigInt(0),o=BigInt(1),a=BigInt(2),l=BigInt(2)**BigInt(31)-BigInt(1),g=~l,c=BigInt(64);function m(u){if(u===s)return 0;if(u>=g&&u<=l)return Number(u);u=u<s?~u*a+o:u*a;let y=0;for(;u;)r[0]=u,y=(y<<7|y>>>25)^B[0],y=(y<<7|y>>>25)^B[1],u=u>>c;return y|0}return m}function e(){let r=BigInt(0),s=BigInt(1),o=BigInt(2),a=BigInt(2)**BigInt(31)-BigInt(1),l=~a,g=BigInt(32),c=BigInt("0xFFFFFFFF");function m(u){if(u===r)return 0;if(u>=l&&u<=a)return Number(u);u=u<r?~u*o+s:u*o;let y=0;for(;u!==r;)y=(y<<7|y>>>25)^Number(u&c),u>>=g,y=(y<<7|y>>>25)^Number(u&c),u>>=g;return y|0}return m}function t(){let r=J();function s(o){return r(o.toString())}return s}return Ne&&He?n():Ne?e():t()}function Tt(){let n="description"in Symbol.prototype?w=>w.description:w=>{let S=w.toString();return S.length>=8&&S.slice(0,7)==="Symbol("&&S.slice(-1)===")"?S.slice(7,-1):S},e=J(),t,r;try{new WeakMap().set(Symbol.iterator,null),t=new WeakMap,r=new WeakMap}catch{t=new Map,r=new Map}for(let w of Object.getOwnPropertyNames(Symbol))if(typeof w=="string"){let S=Symbol[w];typeof S=="symbol"&&r.set(S,`Symbol.${w}`)}let s=J(),o;try{new WeakMap().set(Symbol.for("@esfx/equatable!~globalSymbolTest"),null),o=new WeakMap}catch{o=new Map}let a=J(),l,g=1;try{new WeakMap().set(Symbol(),null),l=new WeakMap}catch{l=new Map}function c(w,S){let k=o.get(w);return k===void 0&&(k=s(S),o.set(w,k)),k}function m(w,S){let k=t.get(w);return k===void 0&&(k=e(S),t.set(w,k)),k}function u(w){let S=l.get(w);return S===void 0&&(S=a(`${g++}#${n(w)}`),l.set(w,S)),S}function y(w){let S=r.get(w);if(S!==void 0)return m(w,S);let k=Symbol.keyFor(w);return k!==void 0?c(w,k):u(w)}return y}function Nt(){let n=new WeakMap,e=me(),t=1;function r(o){return o=~o+(o<<15),o=o^o>>12,o=o+(o<<2),o=o^o>>4,o=o*2057,o=o^o>>16,o>>>0}function s(o){let a=n.get(o);return a===void 0&&(a=r(t++^e)^e,n.set(o,a)),a}return s}function me(){return Math.floor(Math.random()*4294967295)>>>0}var fe=typeof globalThis=="object"?globalThis:typeof global=="object"?global:typeof self=="object"?self:void 0,Be=Symbol.for("@esfx/equatable!~hashUnknown"),pe;fe&&typeof fe[Be]=="function"?pe=fe[Be]:(pe=function(e){switch(typeof e){case"boolean":return e?1:0;case"number":return Je(e);case"bigint":return _e(e);case"string":return et(e);case"symbol":return tt(e);case"function":return Ae(e);case"object":return e===null?0:Ae(e);case"undefined":return 0;default:throw new TypeError(`Unsupported type: ${typeof e}`)}},Object.defineProperty(fe,Be,{value:pe}));function rt(n){return pe(n)}var U;(function(n){n.equals=Symbol.for("@esfx/equatable:Equatable.equals"),n.hash=Symbol.for("@esfx/equatable:Equatable.hash"),n.name="Equatable";function e(t){let r;return t!=null&&n.equals in(r=Object(t))&&n.hash in r}n.hasInstance=e,Object.defineProperty(n,Symbol.hasInstance,{configurable:!0,writable:!0,value:e})})(U||(U={}));var _;(function(n){n.compareTo=Symbol.for("@esfx/equatable:Comparable.compareTo"),n.name="Comparable";function e(t){return t!=null&&n.compareTo in Object(t)}n.hasInstance=e,Object.defineProperty(n,Symbol.hasInstance,{configurable:!0,writable:!0,value:e})})(_||(_={}));var C;(function(n){n.structuralEquals=Symbol.for("@esfx/equatable:StructualEquatable.structuralEquals"),n.structuralHash=Symbol.for("@esfx/equatable:StructuralEquatable.structuralHash"),n.name="StructuralEquatable";function e(t){let r;return t!=null&&n.structuralEquals in(r=Object(t))&&n.structuralHash in r}n.hasInstance=e,Object.defineProperty(n,Symbol.hasInstance,{configurable:!0,writable:!0,value:e})})(C||(C={}));var ee;(function(n){n.structuralCompareTo=Symbol.for("@esfx/equatable:StructuralComparable.structuralCompareTo"),n.name="StructuralComparable";function e(t){return t!=null&&n.structuralCompareTo in Object(t)}n.hasInstance=e,Object.defineProperty(n,Symbol.hasInstance,{configurable:!0,writable:!0,value:e})})(ee||(ee={}));var z;(function(n){let e=Object.defineProperty({},Symbol.toStringTag,{configurable:!0,value:"Equaler"});n.defaultEqualer=t((o,a)=>U.hasInstance(o)?o[U.equals](a):U.hasInstance(a)?a[U.equals](o):Object.is(o,a),o=>U.hasInstance(o)?o[U.hash]():At(o)),n.structuralEqualer=t((o,a)=>C.hasInstance(o)?o[C.structuralEquals](a,n.structuralEqualer):C.hasInstance(a)?a[C.structuralEquals](o,n.structuralEqualer):n.defaultEqualer.equals(o,a),o=>C.hasInstance(o)?o[C.structuralHash](n.structuralEqualer):n.defaultEqualer.hash(o)),n.tupleEqualer=t((o,a)=>{if(o!=null&&!Array.isArray(o)||a!=null&&!Array.isArray(a))throw new TypeError("Array expected");if(o===a)return!0;if(!o||!a||o.length!==a.length)return!1;for(let l=0;l<o.length;l++)if(!n.defaultEqualer.equals(o[l],a[l]))return!1;return!0},o=>{if(o==null)return 0;if(!Array.isArray(o))throw new TypeError("Array expected");let a=0;for(let l of o)a=r(a,n.defaultEqualer.hash(l));return a}),n.tupleStructuralEqualer=t((o,a)=>{if(o!=null&&!Array.isArray(o)||a!=null&&!Array.isArray(a))throw new TypeError("Array expected");if(o===a)return!0;if(!o||!a||o.length!==a.length)return!1;for(let l=0;l<o.length;l++)if(!n.structuralEqualer.equals(o[l],a[l]))return!1;return!0},o=>{if(o==null)return 0;if(!Array.isArray(o))throw new TypeError("Array expected");let a=0;for(let l of o)a=r(a,n.structuralEqualer.hash(l));return a});function t(o,a=n.defaultEqualer.hash){return Object.setPrototypeOf({equals:o,hash:a},e)}n.create=t;function r(o,a,l=7){if(typeof o!="number")throw new TypeError("Integer expected: x");if(typeof a!="number")throw new TypeError("Integer expected: y");if(typeof l!="number")throw new TypeError("Integer expected: rotate");if(isNaN(o)||!isFinite(o))throw new RangeError("Argument must be a finite number value: x");if(isNaN(a)||!isFinite(a))throw new RangeError("Argument must be a finite number value: y");if(isNaN(l)||!isFinite(l))throw new RangeError("Argument must be a finite number value: rotate");for(;l<0;)l+=32;for(;l>=32;)l-=32;return(o<<l|o>>>32-l)^a}n.combineHashes=r;function s(o){return typeof o=="object"&&o!==null&&typeof o.equals=="function"&&typeof o.hash=="function"}n.hasInstance=s,Object.defineProperty(n,Symbol.hasInstance,{configurable:!0,writable:!0,value:s})})(z||(z={}));var fr=z.defaultEqualer,pr=z.structuralEqualer,br=z.tupleEqualer,yr=z.tupleEqualer,wr=z.combineHashes,W;(function(n){let e=Object.defineProperty({},Symbol.toStringTag,{configurable:!0,value:"Comparer"});n.defaultComparer=t((s,o)=>_.hasInstance(s)?s[_.compareTo](o):_.hasInstance(o)?-o[_.compareTo](s):s<o?-1:s>o?1:0),n.structuralComparer=t((s,o)=>ee.hasInstance(s)?s[ee.structuralCompareTo](o,n.structuralComparer):ee.hasInstance(o)?-o[ee.structuralCompareTo](s,n.structuralComparer):n.defaultComparer.compare(s,o)),n.tupleComparer=t((s,o)=>{if(s!=null&&!Array.isArray(s)||o!=null&&!Array.isArray(o))throw new TypeError("Array expected");let a;if(a=n.defaultComparer.compare(s.length,o.length))return a;for(let l=0;l<s.length;l++)if(a=n.defaultComparer.compare(s[l],o[l]))return a;return 0}),n.tupleStructuralComparer=t((s,o)=>{if(s!=null&&!Array.isArray(s)||o!=null&&!Array.isArray(o))throw new TypeError("Array expected");let a;if(a=n.defaultComparer.compare(s.length,o.length))return a;for(let l=0;l<s.length;l++)if(a=n.structuralComparer.compare(s[l],o[l]))return a;return 0});function t(s){return Object.setPrototypeOf({compare:s},e)}n.create=t;function r(s){return typeof s=="object"&&s!==null&&typeof s.compare=="function"}n.hasInstance=r,Object.defineProperty(n,Symbol.hasInstance,{configurable:!0,writable:!0,value:r})})(W||(W={}));var Pr=W.defaultComparer,Er=W.structuralComparer,vr=W.tupleComparer,Sr=W.tupleStructuralComparer;function At(n){return rt(n)}var nt,be=function(){var n={exports:{}};return function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(o,a,l){if(o.length===0)return-1;let g=0,c=o.length-1;for(;g<=c;){let m=g+(c-g>>1),u=o[m];switch(Math.sign(l.compare(u,a))){case-1:g=m+1;break;case 0:return m;case 1:c=m-1;break}}return~g}t.binarySearch=s}(n,n.exports,null),n.exports}(),de=class{constructor(...e){this._keys=[],this._values=[];let t,r;if(e.length>0){let s=e[0];s===void 0||s!=null&&Symbol.iterator in Object(s)?(t=s,e.length>1&&(r=e[1])):r=s}if(r??(r=W.defaultComparer),this._comparer=typeof r=="function"?W.create(r):r,t)for(let[s,o]of t)this.set(s,o)}get comparer(){return this._comparer}get size(){return this._keys.length}has(e){return(0,be.binarySearch)(this._keys,e,this._comparer)>=0}get(e){let t=(0,be.binarySearch)(this._keys,e,this._comparer);return t>=0?this._values[t]:void 0}set(e,t){let r=(0,be.binarySearch)(this._keys,e,this._comparer);return r>=0?this._values[r]=t:(this._keys.splice(~r,0,e),this._values.splice(~r,0,t)),this}delete(e){let t=(0,be.binarySearch)(this._keys,e,this._comparer);return t>=0?(this._keys.splice(t,1),this._values.splice(t,1),!0):!1}clear(){this._keys.length=0,this._values.length=0}keys(){return this._keys.values()}values(){return this._values.values()}*entries(){for(let e=0;e<this._keys.length;e++)yield[this._keys[e],this._values[e]]}[Symbol.iterator](){return this.entries()}forEach(e,t){if(typeof e!="function")throw new TypeError("Function expected: callback");for(let[r,s]of this)e.call(t,s,r,this)}get[R.size](){return this.size}[R.has](e){return this.has(e)}[R.get](e){return this.get(e)}[R.set](e,t){this.set(e,t)}[R.delete](e){return this.delete(e)}[R.clear](){this.clear()}[R.keys](){return this.keys()}[R.values](){return this.values()}};nt=de;Object.defineProperty(nt.prototype,Symbol.toStringTag,{configurable:!0,writable:!0,value:"SortedMap"});var j=T(N(),1);var M=T(N(),1),st=T(N(),1),at=T(ot(),1),H=class{constructor(e,t,r){this.fixedNodes=new Set;this.separation=t,this.rtree=new M.RTree((0,st.createRectangleNodeOnData)(e,s=>this.GetPaddedBoxOfNode(s))),this.pushingNodes=r}get FixedNodes(){return this.fixedNodes}GetPaddedBoxOfNode(e){let t=e.boundaryCurve.boundingBox.clone();return t.pad(this.separation/2),t}PushNodes(){this.fixedNodes.clear(),(0,M.insertRange)(this.fixedNodes,this.pushingNodes);let e=new at.Queue;for(let r of this.pushingNodes)e.enqueue(r);let t=new Array;for(;e.length>0;){let r=e.dequeue();for(let s of this.PushByNodeAndReportPushedAsFixed(r))e.enqueue(s),this.fixedNodes.add(s),t.push(s)}return t}PushByNodeAndReportPushedAsFixed(e){let t=[],r=this.GetPaddedBoxOfNode(e);for(let s of this.rtree.GetAllLeavesIntersectingRectangle(r))this.fixedNodes.has(s.UserData)||this.PushNodeAndUpdateRTree(e,s)&&t.push(s.UserData);return t}PushNodeAndUpdateRTree(e,t){let r=t.UserData.center.sub(e.center),s=e.width/2+t.UserData.width/2,o=e.height/2+t.UserData.height/2,a=Math.abs(r.x),l=Math.abs(r.y),g=a-s,c=l-o;if(g>=this.separation||c>=this.separation)return!1;if(a>=l){let m=r.x>0?this.separation-g:g-this.separation;this.PushByX(m,t)}else{let m=r.y>0?this.separation-c:c-this.separation;this.PushByY(m,t)}return this.UpdateBoundingBoxesOfPushedAndUpParents(t),!0}PushByX(e,t){let r=new M.Point(e,0);H.PushByPoint(t,r)}static PushByPoint(e,t){e.UserData.center=e.UserData.center.add(t),e.UserData instanceof M.GeomGraph&&e.UserData.translate(t)}PushByY(e,t){let r=new M.Point(0,e);H.PushByPoint(t,r)}UpdateBoundingBoxesOfPushedAndUpParents(e){e.irect=this.GetPaddedBoxOfNode(e.UserData);let t=e.Parent;for(;t!=null;)t.irect=t.Left.irect.add_rect(t.Right.irect),t=t.Parent}UpdateRTreeByChangedNodeBox(e,t){let r=this.FindClusterNode(e,t);this.UpdateBoundingBoxesOfPushedAndUpParents(r)}FindClusterNode(e,t){let r=this.rtree.RootNode;return this.FindClusterNodeRecurse(r,e,t)}FindClusterNodeRecurse(e,t,r){if(e.UserData!=null)return e.UserData===t?e:null;let s=null;return r.intersects(e.left.irect)&&(s=this.FindClusterNodeRecurse(e.Left,t,r)),s!=null?s:r.intersects(e.right.irect)?this.FindClusterNodeRecurse(e.Right,t,r):null}FirstPushingNode(){return this.pushingNodes[0]}};var we=class{constructor(e,t,r){this.RelativeLengthOnCurve=e,this.RightSide=t,this.NormalLength=r}};var re=class{constructor(e,t,r){this.listOfPushers=new Array;this.labelFixtures=new Map;this.geomGraph=t,this.nodeSeparation=r.NodeSeparation,this.layoutSettings=r,this.pushingNodesArray=e,this.InitBumperPushers()}get geomGraph(){return this.geomGraph_}set geomGraph(e){this.geomGraph_=e}InitBumperPushers(){if(this.pushingNodesArray.length===0)return;let e=j.GeomGraph.getGeom(this.pushingNodesArray[0].node.parent),t=this.pushingNodesArray;do if(this.listOfPushers.push(new H(e.shallowNodes,this.nodeSeparation,t)),e.graph.parent)e=j.GeomGraph.getGeom(e.graph.parent),t=[e];else break;while(!0)}RunPushers(){for(let e=0;e<this.listOfPushers.length;e++){let t=this.listOfPushers[e];t.PushNodes();let r=t.FirstPushingNode().node.parent;if(r===this.geomGraph_.graph)break;let s=j.GeomGraph.getGeom(r),o=s.boundingBox;if(s.calculateBoundsFromChildren(),s.boundingBox.equalEps(o))break;this.listOfPushers[e+1].UpdateRTreeByChangedNodeBox(s,o)}}Drag(e){if(!(e.x==null&&e.y==null)){for(let t of this.pushingNodesArray)t.translate(e);this.RunPushers(),this.RouteChangedEdges()}}RouteChangedEdges(){this.changedEdges=this.GetChangedEdges(this.GetChangedNodes()),this.InitLabelFixtures(this.changedEdges),new j.SplineRouter(this.geomGraph_,this.changedEdges,this.layoutSettings.commonSettings.edgeRoutingSettings.Padding,this.layoutSettings.commonSettings.edgeRoutingSettings.PolylinePadding,this.layoutSettings.commonSettings.edgeRoutingSettings.ConeAngle,this.layoutSettings.commonSettings.edgeRoutingSettings.bundlingSettings).run(),this.PositionLabels(this.changedEdges)}PositionLabels(e){for(let t of e)this.PositionEdgeLabel(t)}PositionEdgeLabel(e){let t=this.labelFixtures.get(e);if(t==null)return;let r=e.curve,s=r.length*t.RelativeLengthOnCurve,o=r.getParameterAtLength(s),a=r.derivative(o),l=(t.RightSide?a.rotate90Cw():a.rotate90Ccw()).normalize().mul(t.NormalLength);e.label.positionCenter(r.value(o).add(l))}InitLabelFixtures(e){for(let t of e)this.InitLabelFixture(t)}InitLabelFixture(e){if(e.label==null||this.labelFixtures.has(e))return;let t=e.curve.closestParameter(e.label.center),r=e.curve,o=r.derivative(t).rotate90Cw(),a=e.label.center.sub(r.value(t)),l=new we(r.lengthPartial(0,t)/r.length,a.dot(o)>0,a.length);this.labelFixtures.set(e,l)}GetChangedEdges(e){let t=[],r=j.Rectangle.mkOnRectangles(Array.from(e).map(o=>o.boundingBox)),s=r.perimeter();for(let o of this.geomGraph.deepEdges)this.EdgeNeedsRouting(r,o,s,e)&&t.push(o);return t}EdgeNeedsRouting(e,t,r,s){return t.curve==null||s.has(t.source)||s.has(t.target)||t.source.boundingBox.intersects(e)||t.target.boundaryCurve.boundingBox.intersects(e)?!0:t.boundingBox.intersects(e)?j.Curve.intersectionOne(r,t.curve,!1)!=null:!1}GetChangedNodes(){let e=new Set;for(let t of this.listOfPushers)for(let r of t.FixedNodes)e.add(r);return e}};var Pe=T(N(),1);var P=T(N(),1);var X=class{constructor(){this._canUndo=!0}updateDeltaForDragUndo(e){let t=this.data;t.delta=e}registerUndoDrag(e){this.data==null&&(this.data={draggedEnts:new Set,delta:null,changeData:new Map}),"draggedEnts"in this.data&&this.data.draggedEnts.add(e)}undo(){if(P.Assert.assert(this.canUndo),this.data instanceof Map)for(let[e,t]of this.data)for(let r of t)r.new=e.getAttr(Le(r.old)).clone(),r.old.rebind(e);else if(this.data&&"deletedEnts"in this.data)for(let e of this.data.deletedEnts)dt(e);else if("insertedEnts"in this.data)for(let e of this.data.insertedEnts){let t=e.parent;if(e instanceof P.Node)t.removeNode(e);else if(e instanceof P.Edge)e.remove();else throw new Error("not implemented")}else if("draggedEnts"in this.data){for(let e of this.data.draggedEnts)P.GeomObject.getGeom(e).translate(this.data.delta);for(let[e,t]of this.data.changeData)for(let r of t)r.new=e.getAttr(Le(r.old)).clone(),r.old.rebind(e)}else throw new Error("not implemented");this.canUndo=!1}redo(){if(P.Assert.assert(this.canRedo),this.data instanceof Map)for(let[e,t]of this.data)for(let r of t)r.new.rebind(e);else if("deletedEnts"in this.data)for(let e of this.data.deletedEnts)if(e instanceof P.Graph)e.removeSubgraph();else if(e instanceof P.Node)e.parent.removeNode(e);else if(e instanceof P.Edge)e.remove();else if(e instanceof P.Label){let t=e.parent;t.label=null}else throw new Error("unexpected type in redo");else if("draggedEnts"in this.data){let e=this.data.delta.neg();for(let t of this.data.draggedEnts)P.GeomObject.getGeom(t).translate(e);for(let[t,r]of this.data.changeData)for(let s of r)s.new.rebind(t)}else if("insertedEnts"in this.data)for(let e of this.data.insertedEnts)dt(e);else throw new Error("not implemented");this.canUndo=!0}addOldNewPair(e,t){this.data||(this.data=new Map);let r="draggedEnts"in this.data?this.data.changeData:this.data;r.has(e)||r.set(e,[]);let s=Le(t),o=r.get(e);o[s]==null&&(o[s]={old:t.clone(),new:null})}registerDelete(e){this.data||(this.data={deletedEnts:new Set}),this.data.deletedEnts.add(e)}registerAdd(e){this.data||(this.data={insertedEnts:new Set}),this.data.insertedEnts.add(e)}get canRedo(){return!this._canUndo}get canUndo(){return this._canUndo}set canUndo(e){this._canUndo=e}*entities(){if(!!this.data)if(this.data instanceof Map)yield*this.data.keys();else if("draggedEnts"in this.data)yield*this.data.changeData.keys(),yield*this.data.draggedEnts;else if("deletedEnts"in this.data)yield*this.data.deletedEnts;else if("insertedEnts"in this.data)yield*this.data.insertedEnts;else throw new Error("not implemented")}};function Le(n){let e;return n instanceof P.GeomObject?e=P.AttributeRegistry.GeomObjectIndex:n instanceof v?e=P.AttributeRegistry.DrawingObjectIndex:e=P.AttributeRegistry.ViewerIndex,e}function dt(n){if(n instanceof P.Label){let e=n.parent;e.label=n}else if(n instanceof P.Graph){n.parent.addNode(n);for(let t of n.edges)t.add();for(let t of n.nodesBreadthFirst){for(let r of t.outEdges)r.add();for(let r of t.inEdges)r.add()}}else n instanceof P.Node?n.parent.addNode(n):n instanceof P.Edge&&n.add()}var le=class{updateDeltaForDragUndo(e){this.currentBridge.updateDeltaForDragUndo(e)}registerForUndoDrag(e){this.currentBridge==null&&(this.currentBridge=new X),this.currentBridge.registerUndoDrag(e)}registerDelete(e){this.currentBridge==null&&(this.currentBridge=new X),this.currentBridge.registerDelete(e)}registerAdd(e){this.createUndoPoint(),this.currentBridge.registerAdd(e)}*entitiesToBeChangedByRedo(){this.currentBridge!=null&&(this.currentBridge.canRedo?yield*this.currentBridge.entities():this.currentBridge.next!=null&&this.currentBridge.next.canRedo&&(yield*this.currentBridge.next.entities()))}*entitiesToBeChangedByUndo(){this.currentBridge!=null&&(this.currentBridge.canUndo?yield*this.currentBridge.entities():this.currentBridge.prev!=null&&this.currentBridge.prev.canUndo&&(yield*this.currentBridge.prev.entities()))}registerForUndo(e){this.currentBridge==null&&(this.currentBridge=new X),this.currentBridge.addOldNewPair(e,e.getAttr(Pe.AttributeRegistry.GeomObjectIndex))}canUndo(){return this.currentBridge==null?!1:!!(this.currentBridge.canUndo||this.currentBridge.prev!=null&&this.currentBridge.prev.canUndo)}canRedo(){return this.currentBridge==null?!1:!!(this.currentBridge.canRedo||this.currentBridge.next!=null&&this.currentBridge.next.canRedo)}undo(){!this.canUndo||(this.currentBridge.canUndo?this.currentBridge.undo():this.currentBridge.prev.undo(),this.currentBridge.prev&&(this.currentBridge=this.currentBridge.prev))}redo(){!this.canRedo||(this.currentBridge.canRedo?this.currentBridge.redo():this.currentBridge.next.redo(),this.currentBridge.next&&(this.currentBridge=this.currentBridge.next))}createUndoPoint(){let e=new X;if(!this.currentBridge)this.currentBridge=e;else if(this.currentBridge.canUndo)this.currentBridge.next=e,e.prev=this.currentBridge,this.currentBridge=e;else{Pe.Assert.assert(this.currentBridge.canRedo);let t=this.currentBridge.prev;t&&(e.prev=t,t.next=e),this.currentBridge=e}}};var h=T(N(),1);var E=class{constructor(){this.edgesToReroute=new Set;this.objectsToDrag=new Set;this.undoList=new le}updateDeltaForDragUndo(e){this.undoList.updateDeltaForDragUndo(e)}registerDelete(e){this.undoList.registerDelete(e)}registerAdd(e){this.undoList.registerAdd(e)}*entitiesToBeChangedByRedo(){yield*this.undoList.entitiesToBeChangedByRedo()}*entitiesToBeChangedByUndo(){yield*this.undoList.entitiesToBeChangedByUndo()}createUndoPoint(){this.undoList.createUndoPoint()}get LayoutSettings(){return this.graph().layoutSettings}get EdgeRoutingMode(){return this.LayoutSettings.commonSettings.edgeRoutingSettings.EdgeRoutingMode}get canUndo(){return this.undoList.canUndo()}get canRedo(){return this.undoList.canRedo()}static calculateAttachmentSegment(e){let t=h.GeomObject.getGeom(e.parent.entity);if(t!=null)if(E.CalculateAttachedSegmentEnd(e,t),h.Point.closeDistEps(e.attachmentSegmentEnd,e.center))e.attachmentSegmentStart=e.center;else{let r=h.Curve.intersectionOne(e.boundingBox.perimeter(),h.LineSegment.mkPP(e.attachmentSegmentEnd,e.center),!1);e.attachmentSegmentStart=r!=null?r.x:e.center}}static CalculateAttachedSegmentEnd(e,t){e.attachmentSegmentEnd=t.curve.value(t.curve.closestParameter(e.center))}drag(e,t,r){if(!(e.x==0&&e.y==0)){for(let s of this.objectsToDrag)this.registerForUndoDrag(s.entity);this.geomEdgeWithSmoothedPolylineExposed==null?this.EdgeRoutingMode!==h.EdgeRoutingMode.Rectilinear&&this.EdgeRoutingMode!==h.EdgeRoutingMode.RectilinearToCenter?this.dragObjectsForNonRectilinearCase(e,t):this.DragObjectsForRectilinearCase(e):this.dragPolylineCorner(r,e)}}registerForUndoDrag(e){this.undoList.registerForUndoDrag(e)}DragObjectsForRectilinearCase(e){for(let t of this.objectsToDrag)t instanceof h.GeomNode&&t.translate(e);throw h.RectilinearInteractiveEditor.CreatePortsAndRouteEdges(this.LayoutSettings.commonSettings.NodeSeparation/3,1,this.graph().nodesBreadthFirst,this.graph().deepEdges,this.LayoutSettings.commonSettings.edgeRoutingSettings.EdgeRoutingMode),h.EdgeLabelPlacement.constructorG(this.graph()).run(),this.propagateChangesToClusterParents(),new Error("not implemented")}dragObjectsForNonRectilinearCase(e,t){t===0?this.DragIncrementally(e):this.dragWithStraightLines(e)}dragWithStraightLines(e){for(let t of this.objectsToDrag)t instanceof h.GeomGraph?t.deepTranslate(e):t.translate(e);this.propagateChangesToClusterParents(),this.routeEdgesAsStraightLines()}propagateChangesToClusterParents(){let e=new Set;for(let t of this.objectsToDrag){if(!(t instanceof h.GeomNode))continue;let r=t;for(let s of r.node.getAncestors()){let o=h.GeomObject.getGeom(s);o!==this.graph()&&!this.objectsToDrag.has(o)&&e.add(o)}}if(e.size>0)for(let t of this.graph().subgraphsDepthFirst){let r=t;if(e.has(r)){let s=r.getPumpedGraphWithMarginsBox();if(!s.equalEps(r.boundingBox)){this.registerForUndo(r.entity);for(let o of r.selfEdges())this.addToEdgesToReroute(o);for(let o of r.inEdges())this.addToEdgesToReroute(o);for(let o of r.outEdges())this.addToEdgesToReroute(o);r.boundingBox=s}}}}addToEdgesToReroute(e){this.edgesToReroute.add(e)}DragWithSplinesOrBundles(e){for(let t of this.objectsToDrag)t instanceof h.GeomNode&&t.translate(e);this.RunSplineRouterAndPutLabels()}RunSplineRouterAndPutLabels(){h.SplineRouter.mk5(this.graph(),this.LayoutSettings.commonSettings.edgeRoutingSettings.Padding,this.LayoutSettings.commonSettings.edgeRoutingSettings.PolylinePadding,this.LayoutSettings.commonSettings.edgeRoutingSettings.ConeAngle,this.LayoutSettings.commonSettings.edgeRoutingSettings.bundlingSettings).run(),h.EdgeLabelPlacement.constructorG(this.graph()).run()}registerForUndo(e){this.undoList.registerForUndo(e)}routeEdgesAsStraightLines(){for(let t of this.edgesToReroute)this.registerForUndo(t.entity),h.StraightLineEdges.CreateSimpleEdgeCurveWithUnderlyingPolyline(t),t.label&&this.registerForUndo(t.edge.label);h.EdgeLabelPlacement.constructorGA(this.graph(),Array.from(this.edgesToReroute)).run()}DragIncrementally(e){this.incrementalDragger==null&&this.InitIncrementalDragger(),this.incrementalDragger.Drag(e)}dragPolylineCorner(e,t){let r=E.findClosestCornerForEdit(this.geomEdgeWithSmoothedPolylineExposed.smoothedPolyline,e);r.point=r.point.add(t),r.prev==null?lt(this.geomEdgeWithSmoothedPolylineExposed.source,r):r.next==null&&lt(this.geomEdgeWithSmoothedPolylineExposed.target,r),E.createCurveOnChangedPolyline(this.geomEdgeWithSmoothedPolylineExposed)}static dragEdgeWithSite(e,t,r){r.point=r.point.add(e),E.createCurveOnChangedPolyline(t)}static createCurveOnChangedPolyline(e){let t=e.smoothedPolyline.createCurve();h.Arrowhead.trimSplineAndCalculateArrowheadsII(e,e.source.boundaryCurve,e.target.boundaryCurve,t,!1)||h.Arrowhead.createBigEnoughSpline(e),e.sourcePort=new h.RelativeFloatingPort(()=>e.source.boundaryCurve,()=>e.source.center,r().sub(e.source.center)),e.targetPort=new h.RelativeFloatingPort(()=>e.target.boundaryCurve,()=>e.target.center,s().sub(e.target.center));function r(){return e.sourceArrowhead?e.sourceArrowhead.tipPosition:e.curve.start}function s(){return e.targetArrowhead?e.targetArrowhead.tipPosition:e.curve.end}}prepareForObjectDragging(e,t){this.geomEdgeWithSmoothedPolylineExposed=null,this.calculateObjectToDragAndEdgesToReroute(e),this.undoList.createUndoPoint(),t===0&&this.InitIncrementalDragger()}PrepareForClusterCollapseChange(e){throw new Error("not implemented")}InitIncrementalDragger(){this.incrementalDragger=new re(Array.from(this.objectsToDrag).filter(e=>e instanceof h.GeomNode),this.graph(),this.LayoutSettings)}clearDraggedSets(){this.objectsToDrag.clear(),this.edgesToReroute.clear()}addToObjectsToDrag(e){this.objectsToDrag.add(e)}calculateObjectToDragAndEdgesToReroute(e){this.clearDraggedSets();for(let t of e)this.addToObjectsToDrag(t),t instanceof h.GeomEdge&&(this.addToObjectsToDrag(t.source),this.addToObjectsToDrag(t.target));this.removeClusterSuccessorsFromObjectsToDrag(),this.calculateDragSetsForEdges()}removeClusterSuccessorsFromObjectsToDrag(){let e=new Array;for(let t of this.objectsToDrag)this.hasAncestorInObjectsToDrag(t)&&e.push(t);for(let t of e)this.objectsToDrag.delete(t)}calculateDragSetsForEdges(){for(let e of Array.from(this.objectsToDrag))e instanceof h.GeomGraph?this.addGeomGraphEdgesToRerouteOrDrag(e):e instanceof h.GeomNode?this.addNodeEdgesToRerouteOrDrag(e):e instanceof h.GeomEdge&&e.edge.label&&this.addToObjectsToDrag(e.edge.label.getAttr(h.AttributeRegistry.GeomObjectIndex))}addNodeEdgesToRerouteOrDrag(e){h.Assert.assert(!(e instanceof h.GeomGraph));for(let t of e.selfEdges())this.addToObjectsToDrag(t);for(let t of e.inEdges())this.hasSelfOrAncestorInObjectsToDrag(t.source)?this.addToObjectsToDrag(t):this.addToEdgesToReroute(t);for(let t of e.outEdges())this.hasSelfOrAncestorInObjectsToDrag(t.target)?this.addToObjectsToDrag(t):this.addToEdgesToReroute(t);if(e instanceof h.GeomGraph)for(let t of e.nodesBreadthFirst)this.addNodeEdgesToRerouteOrDrag(t)}addGeomGraphEdgesToRerouteOrDrag(e){h.Assert.assert(e instanceof h.GeomGraph);for(let t of e.selfEdges())this.addToObjectsToDrag(t);for(let t of e.inEdges())e.isAncestor(t.source)||(this.hasSelfOrAncestorInObjectsToDrag(t.source)?this.addToObjectsToDrag(t):this.addToEdgesToReroute(t));for(let t of e.outEdges())e.isAncestor(t.target)||(this.hasSelfOrAncestorInObjectsToDrag(t.target)?this.addToObjectsToDrag(t):this.addToEdgesToReroute(t));for(let t of e.nodesBreadthFirst){for(let r of t.outEdges()){let s=r.target;e.isAncestor(s)||(this.hasSelfOrAncestorInObjectsToDrag(s)?this.addToObjectsToDrag(r):this.addToEdgesToReroute(r))}for(let r of t.inEdges()){let s=r.source;e.isAncestor(s)||(this.hasSelfOrAncestorInObjectsToDrag(s)?this.addToObjectsToDrag(r):this.addToEdgesToReroute(r))}}}hasSelfOrAncestorInObjectsToDrag(e){for(;e;){if(this.objectsToDrag.has(e))return!0;e=e.parent}return!1}hasAncestorInObjectsToDrag(e){for(e=e.parent;e;){if(this.objectsToDrag.has(e))return!0;e=e.parent}return!1}static CalculateMiddleOffsetsForMultiedge(e,t,r,s){let o=E.GetMiddleAnglesOfMultiedge(e,t),a=Array.from(o.values()),l=s*6,g=a.length/2,c=g*2===a.length,m;if(c){m=-(l/2);for(let u=g-1;u>=0;u--){let y=a[u];r.set(y,m),m-=l+(y.label?y.label.width:0)}m=l/2;for(let u=g;u<a.length;u++){let y=a[u];r.set(y,m),m+=l+(y.label?y.label.width:0)}}else{m=0;for(let u=g;u>=0;u--){let y=a[u];r.set(y,m),m=l+(y.label?y.label.width:0)}m=l;for(let u=g+1;u<a.length;u++){let y=a[u];r.set(y,m),m+=l+(y.label?y.label.width:0)}}}static GetMiddleAnglesOfMultiedge(e,t){let r=new de,s=e[0],o=t.center,a=E.Middle(s.curve);r.set(0,s);for(let l=1;l<e.length;l++){let g=e[l],c=E.Middle(g.curve),m=h.Point.anglePCP(a,o,c);m>Math.PI&&(m-=Math.PI*2),r.set(m,g)}return r}static Middle(e){return e.value(.5*e.parStart+.5*e.parEnd)}static*GetMultiEdges(e){let t=new Map;for(let r of e.outEdges())E.GetOrCreateListOfMultiedge(t,r.target).push(r);for(let r of e.inEdges())E.GetOrCreateListOfMultiedge(t,r.source).push(r);for(let r of t.values())r.length>1&&(yield r)}static GetOrCreateListOfMultiedge(e,t){let r=e.get(t);return r||(e.set(t,r=[]),r)}prepareForGeomEdgeChange(e){h.Assert.assert(this.geomEdgeWithSmoothedPolylineExposed===e),this.createUndoPoint(),this.registerForUndo(e.edge)}undo(){this.undoList.undo()}redo(){this.undoList.redo()}clear(){this.objectsToDrag=new Set,this.edgesToReroute.clear(),this.undoList=new le}static getPreviousCornerSite(e,t){let r=e.smoothedPolyline.headSite,s=r.next;for(;s!=null;){if(E.betweenSites(r,s,t))return r;r=s,s=s.next}return null}static betweenSites(e,t,r){let s=h.LineSegment.closestParameterOnLineSegment(r,e.point,t.point);return s>.1&&s<.9}insertSite(e,t,r){this.prepareForGeomEdgeChange(e);let s=h.CornerSite.mkSiteSPS(r,t,r.next);E.dragEdgeWithSite(new h.Point(0,0),e,s)}deleteSite(e,t){this.prepareForGeomEdgeChange(e),h.Assert.assert(this.geomEdgeWithSmoothedPolylineExposed===e),t.prev.next=t.next,t.next.prev=t.prev,E.dragEdgeWithSite(new h.Point(0,0),e,t.prev)}static findClosestCornerForEdit(e,t,r=Number.POSITIVE_INFINITY){r!==Number.POSITIVE_INFINITY&&(r*=r);let s=e.headSite,o=s,a=o.point.sub(t).lengthSquared;for(;s.next!=null;){s=s.next;let l=t.sub(s.point).lengthSquared;l<a&&(o=s,a=l)}return a>r?null:o}ReactOnViewChange(){}ForgetDragging(){this.incrementalDragger=null}};function lt(n,e){let t=n.boundaryCurve;if(h.Curve.PointRelativeToCurveLocation(e.point,t)!=h.PointLocation.Outside)return;let s=h.LineSegment.mkPP(n.center,e.point),o=h.Curve.intersectionOne(s,t,!1);o&&(e.point=o.x)}var Ee=(r=>(r[r.Default=0]="Default",r[r.Node=1]="Node",r[r.Edge=2]="Edge",r))(Ee||{});var ve=(o=>(o[o.None=0]="None",o[o.Alt=1]="Alt",o[o.Control=2]="Control",o[o.Shift=4]="Shift",o[o.Windows=8]="Windows",o))(ve||{});function D(n){return n.getAttr(d.AttributeRegistry.ViewerIndex)}function ge(n){return d.GeomObject.getGeom(n.entity)}function Mt(n){return n&&n.entity instanceof d.Node}var I=class{constructor(e){this.RadiusOfPolylineCorner=10;this.geomEdge=new d.GeomEdge(null);this.EdgeAttr=new O(null,!0);this.arrowheadLength=d.Arrowhead.defaultArrowheadLength;this.dragGroup=new Set;this.geomGraphEditor=new E;this.mouseMoveThreshold=.05;this.sourceLoosePolylineWrap={loosePolyline:null};this.sourceOfInsertedEdgeWrap={node:null};this.sourcePortWrap={port:null};this.targetOfInsertedEdgeWrap={node:null};this.targetPortWrap={port:null};this.dragging=!1;this.edgeAttr=new O(null,!0);this.viewer=e,this.decorateObjectForDragging=this.defaultObjectDecorator,this.removeObjDraggingDecorations=this.defaultObjectDecoratorRemover,this.DecorateEdgeForDragging=I.TheDefaultEdgeDecoratorStub,this.decorateEdgeLabelForDragging=this.defaultEdgeLabelDecorator,this.RemoveEdgeDraggingDecorations=I.TheDefaultEdgeDecoratorStub,this.geomGraphEditor.graph=()=>d.GeomGraph.getGeom(this._graph)}resizeLabel(e,t){let r=t.getAttr(d.AttributeRegistry.DrawingObjectIndex);r.labelText=e,this.viewer.invalidate(t.getAttr(d.AttributeRegistry.ViewerIndex))}get hasEdgeInsertionPort(){return this.SourcePort!=null||this.TargetPort!=null}get insertingEdge(){return this.insertionMode==2}createUndoPoint(){this.geomGraphEditor.createUndoPoint()}registerDelete(e){this.geomGraphEditor.registerDelete(e)}registerAdd(e){this.geomGraphEditor.registerAdd(e)}forget(e){this.dragGroup.delete(e),this.edgeWithSmoothedPolylineExposed===e&&(this.edgeWithSmoothedPolylineExposed=null)}get edgeWithSmoothedPolylineExposed(){return this._edgeWithSmoothedPolylineExposed}set edgeWithSmoothedPolylineExposed(e){this._edgeWithSmoothedPolylineExposed!==e&&this._edgeWithSmoothedPolylineExposed&&(this._edgeWithSmoothedPolylineExposed.selectedForEditing=!1),this._edgeWithSmoothedPolylineExposed=e,e?(e.selectedForEditing=!0,this.geomGraphEditor.geomEdgeWithSmoothedPolylineExposed=d.GeomEdge.getGeom(e.edge)):this.geomGraphEditor.geomEdgeWithSmoothedPolylineExposed=null}get ActiveDraggedObject(){return this.aActiveDraggedObject}set ActiveDraggedObject(e){this.aActiveDraggedObject=e}get interactiveEdgeRouter(){return this._interactiveEdgeRouter}set interactiveEdgeRouter(e){this._interactiveEdgeRouter=e}ViewerObjectUnderMouseCursorChanged(e,t){this.TargetPort!=null&&(this.viewer.RemoveTargetPortEdgeRouting(),this.TargetPort=null)}ViewChangeEventHandler(e,t){this._graph!=null}get graph(){return this._graph}set graph(e){this._graph=e,this.geomGraphEditor.clear()}get MouseMoveThreshold(){return this.mouseMoveThreshold}set MouseMoveThreshold(e){this.mouseMoveThreshold=e}get DecorateEdgeForDragging(){return this.decorateEdgeForDragging}set DecorateEdgeForDragging(e){this.decorateEdgeForDragging=e}get RemoveEdgeDraggingDecorations(){return this.removeEdgeDraggingDecorations}set RemoveEdgeDraggingDecorations(e){this.removeEdgeDraggingDecorations=e}get NodeInsertPredicate(){return this.nodeInsertPredicate}set NodeInsertPredicate(e){this.nodeInsertPredicate=e}get SourceOfInsertedEdge(){return this.sourceOfInsertedEdgeWrap.node}set SourceOfInsertedEdge(e){this.sourceOfInsertedEdgeWrap.node=e}get TargetOfInsertedEdge(){return this.targetOfInsertedEdgeWrap.node}set TargetOfInsertedEdge(e){this.targetOfInsertedEdgeWrap.node=e}get SourcePort(){return this.sourcePortWrap.port}set SourcePort(e){this.sourcePortWrap.port=e}get TargetPort(){return this.targetPortWrap.port}set TargetPort(e){this.targetPortWrap.port=e}get CanUndo(){return this.geomGraphEditor.canUndo}get CanRedo(){return this.geomGraphEditor.canRedo}get insertionMode(){return this.viewer==null?0:this.viewer.insertionMode}set insertionMode(e){this.viewer!=null&&(this.viewer.insertionMode=e)}viewerGraphChanged(){this._graph=this.viewer.graph,this.geomGraphEditor.clear(),this._graph!=null&&d.GeomGraph.getGeom(this._graph)!=null&&this.geomGraphEditor.clear(),this.ActiveDraggedObject=null,this.dragGroup.clear(),this.cleanObstacles()}cleanObstacles(){this.interactiveEdgeRouter=null,this.looseObstaclesToTheirViewerNodes=null,this.SourceOfInsertedEdge=null,this.TargetOfInsertedEdge=null,this.SourcePort=null,this.TargetPort=null,this.viewer.RemoveSourcePortEdgeRouting(),this.viewer.RemoveTargetPortEdgeRouting()}RelayoutOnIsCollapsedChanged(e){this.geomGraphEditor.PrepareForClusterCollapseChange([e]);let t=d.GeomGraph.getGeom(e.node);t.isCollapsed?this.CollapseCluster(e.node):this.ExpandCluster(t);for(let r of this.geomGraphEditor.entitiesToBeChangedByUndo())this.invalidate(r)}relayout(e){let t=e;for(;t.parent!=null;)t=t.parent;(0,d.layoutGeomGraph)(t),this.MakeExpandedNodesVisible(e.entity)}ExpandCluster(e){e!=null&&this.relayout(e)}MakeExpandedNodesVisible(e){for(let t of e.shallowNodes){let r=D(t);I.UnhideNodeEdges(t),r.isVisible=!0,t instanceof d.Graph&&t.getAttr(d.AttributeRegistry.GeomObjectIndex).isCollapsed==!1&&this.MakeExpandedNodesVisible(t)}}static UnhideNodeEdges(e){for(let t of e.selfEdges){let r=D(t);r.isVisible=!0}for(let t of e.outEdges)D(t.target).isVisible&&(D(t).isVisible=!0);for(let t of e.inEdges)D(t.source).isVisible&&(D(t).isVisible=!0)}CollapseCluster(e){I.HideCollapsed(e);let t=d.GeomGraph.getGeom(e),r=t.center;t.boundingBox=d.Rectangle.mkSizeCenter(t.labelSize,r),this.relayout(t)}static HideCollapsed(e){for(let t of e.shallowNodes)D(t).isVisible=!1,t instanceof d.Graph&&d.GeomGraph.getGeom(t).isCollapsed==!1&&I.HideCollapsed(t)}defaultObjectDecorator(e){if(e.entity instanceof d.Label){this.decorateEdgeLabelForDragging(e);return}let t=G.getDrawingObj(e.entity),r=t.penwidth;e.unmarkedForDraggingCallback||(e.unmarkedForDraggingCallback=()=>v.getDrawingObj(e.entity).penwidth=r),t.penwidth=Math.max(this.viewer.LineThicknessForEditing,r*2),this.invalidate(e.entity)}defaultObjectDecoratorRemover(e){let t=e.unmarkedForDraggingCallback;t&&(t(),e.unmarkedForDraggingCallback=null,this.invalidate(e.entity));let r=e.entity;if(r instanceof d.Node)for(let s of r.edges)this.removeObjDraggingDecorations(D(s))}static TheDefaultEdgeDecoratorStub(e){}defaultEdgeLabelDecorator(e){let t=e.entity.getAttr(d.AttributeRegistry.GeomObjectIndex);e.markedForDragging&&(E.calculateAttachmentSegment(t),e.unmarkedForDraggingCallback=()=>{this.invalidate(e.entity)}),this.invalidate(e.entity)}static LeftButtonIsPressed(e){return(e.buttons&1)==1}static MiddleButtonIsPressed(e){return(e.buttons&4)==4}static RightButtonIsPressed(e){return(e.buttons&2)==2}MouseDownPointAndMouseUpPointsAreFarEnoughOnScreen(e){if(this.mouseDownScreenPoint==null)return!1;let t=e.clientX,r=e.clientY,s=(this.mouseDownScreenPoint.x-t)/this.viewer.DpiX,o=(this.mouseDownScreenPoint.y-r)/this.viewer.DpiY;return Math.sqrt(s*s+o*o)>this.MouseMoveThreshold/3}analyzeLeftMouseButtonClick(e){this.edgeWithSmoothedPolylineExposed?this.toggleCornerForSelectedEdge():this.viewer.objectUnderMouseCursor&&this.analyzeLeftMouseButtonClickOnObjectUnderCursor(e)}analyzeLeftMouseButtonClickOnObjectUnderCursor(e){let t=this.viewer.objectUnderMouseCursor,r=e.ctrlKey||e.shiftKey,s=t.entity;if(s instanceof d.Edge){let o=s.getAttr(d.AttributeRegistry.GeomObjectIndex);o!=null&&this.viewer.layoutEditingEnabled&&(o.smoothedPolyline==null&&(o.smoothedPolyline=I.CreateUnderlyingPolyline(o)),this.edgeWithSmoothedPolylineExposed!==t&&this.switchToEdgeEditing(t))}else t.markedForDragging?this.unselectForDragging(t):(r||this.unselectEverything(),this.selectObjectForDragging(t)),this.unselectEdge()}toggleCornerForSelectedEdge(){let e=E.findClosestCornerForEdit(d.GeomEdge.getGeom(this.edgeWithSmoothedPolylineExposed.edge).smoothedPolyline,this.mouseDownGraphPoint,this.edgeWithSmoothedPolylineExposed.radiusOfPolylineCorner);if(e==null)this.tryInsertCorner();else{if(e.prev==null||e.next==null)return;this.geomGraphEditor.createUndoPoint(),this.geomGraphEditor.registerForUndo(this.edgeWithSmoothedPolylineExposed.edge),this.geomGraphEditor.deleteSite(d.GeomEdge.getGeom(this.edgeWithSmoothedPolylineExposed.edge),e),this.invalidate(this.edgeWithSmoothedPolylineExposed.entity)}}tryInsertCorner(){if(!this.closeEnoughToSelectedEdge())this.unselectEdge();else{let e=E.getPreviousCornerSite(d.GeomEdge.getGeom(this.edgeWithSmoothedPolylineExposed.edge),this.mouseDownGraphPoint);if(e==null||e.next==null)return;this.geomGraphEditor.insertSite(d.GeomEdge.getGeom(this.edgeWithSmoothedPolylineExposed.edge),this.mouseDownGraphPoint,e),this.invalidate(this.edgeWithSmoothedPolylineExposed.edge)}}closeEnoughToSelectedEdge(){let e=d.GeomEdge.getGeom(this.edgeWithSmoothedPolylineExposed.edge).curve,t=e.closestParameter(this.mouseDownGraphPoint);return e.value(t).sub(this.mouseDownGraphPoint).length<this.edgeWithSmoothedPolylineExposed.radiusOfPolylineCorner}static CreateUnderlyingPolyline(e){return d.SmoothedPolyline.mkFromPoints(I.CurvePoints(e))}static*CurvePoints(e){if(yield e.source.center,e.curve instanceof d.Curve){let r=e.curve;r.segs.length>0&&(yield r.start);for(let s=0;s<r.segs.length;s++)yield r.segs[s].end}yield e.target.center}ModifierKeyIsPressed(){return(this.viewer.modifierKeys&2)==2||(this.viewer.modifierKeys&4)==4}switchToEdgeEditing(e){this.unselectEverything(),this.edgeWithSmoothedPolylineExposed=e,e.radiusOfPolylineCorner=this.viewer.smoothedPolylineCircleRadius,this.DecorateEdgeForDragging(e),this.invalidate(e.entity)}*ViewerNodes(){for(let e of this.viewer.entities)e.entity instanceof d.Node&&(yield e.entity.getAttr(d.AttributeRegistry.ViewerIndex))}selectObjectForDragging(e){e.markedForDragging==!1&&(e.markedForDragging=!0,this.dragGroup.add(e),this.decorateObjectForDragging(e))}prepareToRemoveFromDragGroup(e){e.markedForDragging=!1,this.removeObjDraggingDecorations(e)}unselectForDragging(e){this.prepareToRemoveFromDragGroup(e),this.dragGroup.delete(e)}unselectEverything(){for(let e of this.dragGroup)this.prepareToRemoveFromDragGroup(e);this.dragGroup.clear(),this.unselectEdge()}unselectEdge(){this.edgeWithSmoothedPolylineExposed!=null&&(this.edgeWithSmoothedPolylineExposed.selectedForEditing=!1,this.removeEdgeDraggingDecorations(this.edgeWithSmoothedPolylineExposed),this.invalidate(this.edgeWithSmoothedPolylineExposed.edge),this.edgeWithSmoothedPolylineExposed=null)}static*Edges(e){for(let t of e.entity.edges)yield D(t)}viewerMouseDown(e,t){if(!this.viewer.layoutEditingEnabled||this.viewer.graph==null||(this.viewer.setObjectUnderCursorFromEvent(t),this.mouseDownGraphPoint=this.viewer.screenToSource(t),this.mouseDownScreenPoint=new d.Point(t.clientX,t.clientY),!I.LeftButtonIsPressed(t)))return!1;if(this.leftMouseButtonWasPressed=!0,this.insertingEdge)return!0;if(this.insertionMode==1)return this.insertNode(),!0;if(this.edgeWithSmoothedPolylineExposed!=null)return this.mouseIsInsideOfCornerSite(t)&&t.preventDefault(),!0;let r=this.viewer.objectUnderMouseCursor;return r&&!this.viewer.objectUnderMouseCursor.hasOwnProperty("edge")?(this.ActiveDraggedObject=r,!0):this.ActiveDraggedObject!=null?(t.preventDefault(),!0):!1}insertNode(){let e=this.findNodeID(),t=new d.Node(e);this._graph.addNode(t),new G(t);let r=this.viewer.createIViewerNodeN(t,this.mouseDownGraphPoint);this.viewer.addNode(r,!0)}findNodeID(){let e=0,t="node"+e.toString();for(;this._graph.findNode(t);)t="node"+ ++e;return t}viewerMouseMove(e,t){!this.viewer.layoutEditingEnabled||(I.LeftButtonIsPressed(t)?this.ActiveDraggedObject!=null||this.activeCornerSite!=null?this.drag(t):this.insertingEdge?this.mouseMoveInsertEdgeLeftButtonOn(t):this.MouseMoveLiveSelectObjectsForDragging(t):this.insertingEdge&&this.mouseMoveInsertEdgeNoButtons(t))}setDraggingFlag(e){!this.dragging&&this.MouseDownPointAndMouseUpPointsAreFarEnoughOnScreen(e)&&(this.dragging=!0)}TrySetNodePort(e,t,r,s){if(this.graph==null)return;d.Assert.assert(this.insertingEdge);let o=this.viewer.screenToSource(e);return s.loosePolyline=null,this.DraggingStraightLine()?t.node=this.setPortWhenDraggingStraightLine(r,o):(this.interactiveEdgeRouter==null&&this.PrepareForEdgeDragging(),s.loosePolyline=this.interactiveEdgeRouter.GetHitLoosePolyline(o),s.loosePolyline!=null?this.SetPortUnderLoosePolyline(o,s.loosePolyline,t,r):(t.node=null,r.port=null)),r.port!=null}setPortWhenDraggingStraightLine(e,t){if(Mt(this.viewer.objectUnderMouseCursor)){let r=this.viewer.objectUnderMouseCursor,s={portParameter:0},o=ge(r);return this.NeedToCreateBoundaryPort(t,r,s)?e.port=this.CreateOrUpdateCurvePort(s.portParameter,o,e.port):I.PointIsInside(t,o.boundaryCurve)?e.port=this.CreateFloatingPort(o,t):e.port=null,r}return e.port=null,null}CreateOrUpdateCurvePort(e,t,r){if(!(r instanceof d.CurvePort))return d.CurvePort.mk(t.boundaryCurve,e);let o=r;return o.parameter=e,o.curve=t.boundaryCurve,r}CreateFloatingPort(e,t){return new d.FloatingPort(e.boundaryCurve,t)}SetPortUnderLoosePolyline(e,t,r,s){let o=Number.POSITIVE_INFINITY,a=0;for(let l of this.GetViewerNodesInsideOfLooseObstacle(t)){let g=l.entity.getAttr(d.AttributeRegistry.GeomObjectIndex).boundaryCurve;if(I.PointIsInside(e,g)){r.node=l,this.SetPortForMousePositionInsideOfNode(e,r.node,s);return}let c=g.closestParameter(e),m=g.value(c).sub(e).length;m<o&&(a=c,o=m,r.node=l)}s.port=this.CreateOrUpdateCurvePort(a,ge(r.node),s.port)}GetViewerNodesInsideOfLooseObstacle(e){return this.looseObstaclesToTheirViewerNodes==null&&this.InitLooseObstaclesToViewerNodeMap(),this.looseObstaclesToTheirViewerNodes.get(e)}InitLooseObstaclesToViewerNodeMap(){this.looseObstaclesToTheirViewerNodes=new Map;for(let e of this.ViewerNodes()){let t=this.interactiveEdgeRouter.GetHitLoosePolyline(ge(e).center),r=this.looseObstaclesToTheirViewerNodes.get(t);r==null&&this.looseObstaclesToTheirViewerNodes.set(t,r=new Array),r.push(e)}}SetPortForMousePositionInsideOfNode(e,t,r){let s=ge(t),o={portParameter:0};this.NeedToCreateBoundaryPort(e,t,o)?r.port=this.CreateOrUpdateCurvePort(o.portParameter,s,r.port):r.port=this.CreateFloatingPort(s,e)}static PointIsInside(e,t){return d.Curve.PointRelativeToCurveLocation(e,t)==d.PointLocation.Inside}NeedToCreateBoundaryPort(e,t,r){let s=t.entity.getAttr(d.AttributeRegistry.DrawingObjectIndex),o=ge(t).boundaryCurve;r.portParameter=o.closestParameter(e);let a=o.value(r.portParameter);return e.sub(a).length<=this.viewer.smoothedPolylineCircleRadius*2+s.penwidth/2?(this.TryToSnapToTheSegmentEnd(r,o,a),!0):!1}TryToSnapToTheSegmentEnd(e,t,r){if(t instanceof d.Curve){let s=t.getSegIndexParam(e.portParameter),o=s.par,a=t.segs[s.segIndex];o-a.parStart<a.parEnd-o&&(a.start.sub(r).length<this.viewer.smoothedPolylineCircleRadius*2?e.portParameter-=o-a.parStart:a.end.sub(r).length<this.viewer.smoothedPolylineCircleRadius*2&&(e.portParameter+=+(a.parEnd-o)))}}drag(e){if(!this.dragging)if(this.MouseDownPointAndMouseUpPointsAreFarEnoughOnScreen(e))this.prepareFirstTimeDragging();else return;let t=this.viewer.screenToSource(e);this.handleTheMouseCursorOutOfTheBoundingBox(t),this.geomGraphEditor.drag(t.sub(this._lastDragPoint),this.GetDraggingMode(),this._lastDragPoint);for(let r of this.geomGraphEditor.entitiesToBeChangedByUndo())this.invalidate(r);e.stopPropagation(),this._lastDragPoint=t}prepareFirstTimeDragging(){this.dragging=!0,this.activeCornerSite!=null?this.geomGraphEditor.prepareForGeomEdgeChange(this.edgeWithSmoothedPolylineExposed.edge.getAttr(d.AttributeRegistry.GeomObjectIndex)):this.ActiveDraggedObject!=null&&(this.unselectEdge(),this.ActiveDraggedObject.markedForDragging||this.unselectEverything(),this.prepareForDragging()),this._lastDragPoint=this.mouseDownGraphPoint}handleTheMouseCursorOutOfTheBoundingBox(e){let t=this.viewer.smoothedPolylineCircleRadius,r=d.Rectangle.mkSizeCenter(new d.Size(t,t),e),s=d.GeomGraph.getGeom(this._graph);s.boundingBox.containsRect(r)||(this.geomGraphEditor.registerForUndo(this._graph),s.boundingBox=s.boundingBox.addRec(r),this.invalidate(this._graph))}prepareForDragging(){this.selectObjectForDragging(this.ActiveDraggedObject),this.geomGraphEditor.prepareForObjectDragging(this.DraggedGeomObjects(),this.GetDraggingMode())}GetDraggingMode(){return(this.viewer.modifierKeys&4)==4||this.viewer.IncrementalDraggingModeAlways?0:1}static RouteEdgesRectilinearly(e){let t=e.graph.getAttr(d.AttributeRegistry.GeomObjectIndex),r=t.layoutSettings;d.RectilinearInteractiveEditor.CreatePortsAndRouteEdges(r.commonSettings.NodeSeparation/3,1,t.nodesBreadthFirst,t.deepEdges,r.commonSettings.edgeRoutingSettings.EdgeRoutingMode),d.EdgeLabelPlacement.constructorG(t).run()}*DraggedGeomObjects(){let e=I.GetActiveObjectCluster(this.ActiveDraggedObject);for(let t of this.dragGroup)I.GetActiveObjectCluster(t)==e&&(yield d.GeomObject.getGeom(t.entity))}static GetActiveObjectCluster(e){return e.entity.parent}viewerMouseUp(e,t){t.defaultPrevented||!this.viewer.layoutEditingEnabled||this.handleMouseUpOnLayoutEnabled(t)}handleMouseUpOnLayoutEnabled(e){if(!this.MouseDownPointAndMouseUpPointsAreFarEnoughOnScreen(e)&&this.leftMouseButtonWasPressed)this.viewer.objectUnderMouseCursor!=null||this.edgeWithSmoothedPolylineExposed!=null?(this.analyzeLeftMouseButtonClick(e),e.preventDefault()):this.unselectEverything();else if(this.dragging){this.insertingEdge?this.InsertEdgeOnMouseUp():(this.geomGraphEditor.updateDeltaForDragUndo(this.mouseDownGraphPoint.sub(this._lastDragPoint)),this.interactiveEdgeRouter=null,this.looseObstaclesToTheirViewerNodes=null);let r=d.GeomGraph.getGeom(this._graph),s=r.getPumpedGraphWithMarginsBox();s.equal(r.boundingBox)||(this.geomGraphEditor.registerForUndo(this._graph),r.boundingBox=s,this.invalidate(this._graph),e.preventDefault())}this.dragging=!1,this.geomGraphEditor.ForgetDragging(),this.activeCornerSite=null,this.ActiveDraggedObject=null,this.leftMouseButtonWasPressed=!1,this.TargetPort!=null&&this.viewer.RemoveTargetPortEdgeRouting(),this.SourcePort!=null&&this.viewer.RemoveSourcePortEdgeRouting(),this.TargetOfInsertedEdge=null,this.SourceOfInsertedEdge=null,this.TargetPort=null,this.SourcePort=null}InsertEdgeOnMouseUp(){if(this.viewer.stopDrawingRubberEdge(),this.TargetPort!=null){let e=this.FinishRoutingEdge();this.addEdgeToTheViewer(e)}this.interactiveEdgeRouter.Clean()}addEdgeToTheViewer(e){let t=this.viewer.createEdgeWithGivenGeometry(e);this.viewer.addEdge(t,!0)}mkArrowhead(){let e=new d.Arrowhead;return e.length=this.arrowheadLength,e}FinishRoutingEdge(){let e=new d.Edge(this.sourceOfInsertedEdgeWrap.node.entity,this.targetOfInsertedEdgeWrap.node.entity);e.add();let t=this.EdgeAttr.clone();return t.rebind(e),this.geomEdge.rebind(e),this.geomEdge.sourceArrowhead=t.arrowtail==6?null:this.mkArrowhead(),this.geomEdge.targetArrowhead=t.arrowhead==6?null:this.mkArrowhead(),this.TargetOfInsertedEdge!=this.SourceOfInsertedEdge?(this.geomEdge.curve instanceof d.LineSegment||(this.interactiveEdgeRouter.TryToRemoveInflectionsAndCollinearSegments(this.geomEdge.smoothedPolyline),this.interactiveEdgeRouter.SmoothenCorners(this.geomEdge.smoothedPolyline),this.geomEdge.curve=this.geomEdge.smoothedPolyline.createCurve()),d.Arrowhead.trimSplineAndCalculateArrowheads(this.geomEdge,this.geomEdge.curve,!0)):this.geomEdge=I.CreateEdgeGeometryForSelfEdge(this.SourceOfInsertedEdge.entity),this.viewer.RemoveSourcePortEdgeRouting(),this.viewer.RemoveTargetPortEdgeRouting(),e}static CreateEdgeGeometryForSelfEdge(e){let t=new d.Edge(e,e),r=new d.GeomEdge(t);return d.StraightLineEdges.CreateSimpleEdgeCurveWithUnderlyingPolyline(r),r}SelectEntitiesForDraggingWithRectangle(e){}mouseIsInsideOfCornerSite(e){let t=this.viewer.screenToSource(e),r=this.edgeWithSmoothedPolylineExposed.edge.getAttr(d.AttributeRegistry.DrawingObjectIndex).penwidth;return this.activeCornerSite=E.findClosestCornerForEdit(d.GeomEdge.getGeom(this.edgeWithSmoothedPolylineExposed.edge).smoothedPolyline,t,this.edgeWithSmoothedPolylineExposed.radiusOfPolylineCorner+r),this.activeCornerSite!==null}MouseScreenPointIsCloseEnoughToVertex(e,t){return e.sub(this.mouseDownGraphPoint).length<t}invalidate(e){let t=D(e);if(!!t){if(t.entity instanceof d.Label){if(t.markedForDragging){let r=d.GeomObject.getGeom(t.entity);E.calculateAttachmentSegment(r)}}else t.entity instanceof d.Edge&&t.entity.label&&this.viewer.invalidate(D(t.entity.label));if(this.viewer.invalidate(t),e instanceof d.Graph){for(let r of e.nodesBreadthFirst)this.viewer.invalidate(D(r));for(let r of e.deepEdges)this.viewer.invalidate(D(r)),r.label&&this.viewer.invalidate(D(r.label))}}}undo(){if(this.geomGraphEditor.canUndo){let e=new Set(this.geomGraphEditor.entitiesToBeChangedByUndo());this.geomGraphEditor.undo();for(let t of e){let r=D(t);r.markedForDragging?this.dragGroup.add(r):this.dragGroup.delete(r),this.invalidate(t)}}}redo(){if(this.geomGraphEditor.canRedo){let e=new Set(this.geomGraphEditor.entitiesToBeChangedByRedo());this.geomGraphEditor.redo();for(let t of e){let r=D(t);r.markedForDragging?this.dragGroup.add(r):this.dragGroup.delete(r),this.invalidate(t)}}}static RectRouting(e){return e==d.EdgeRoutingMode.Rectilinear||e==d.EdgeRoutingMode.RectilinearToCenter}PrepareForEdgeDragging(){if(this.viewer.graph==null||this.DraggingStraightLine())return;let e=d.GeomGraph.getGeom(this.viewer.graph).layoutSettings;if(!I.RectRouting(e.commonSettings.edgeRoutingSettings.EdgeRoutingMode)&&this.interactiveEdgeRouter==null){let t=e.commonSettings.NodeSeparation/3,r=.65*t;this.interactiveEdgeRouter=d.InteractiveEdgeRouter.constructorANNN(Array.from(this._graph.nodesBreadthFirst).map(s=>d.GeomNode.getGeom(s).boundaryCurve),t,r,0)}}mouseMoveInsertEdgeNoButtons(e){let t=this.SourceOfInsertedEdge;this.TrySetNodePort(e,this.sourceOfInsertedEdgeWrap,this.sourcePortWrap,this.sourceLoosePolylineWrap)?this.viewer.SetSourcePortForEdgeRouting(this.sourcePortWrap.port.Location):t!=null&&this.viewer.RemoveSourcePortEdgeRouting()}mouseMoveInsertEdgeLeftButtonOn(e){if(this.SourcePort!=null){if(this.setDraggingFlag(e),this.dragging){let t={loosePolyline:null};this.TrySetNodePort(e,this.targetOfInsertedEdgeWrap,this.targetPortWrap,t)?(this.viewer.setTargetPortForEdgeRouting(this.targetPortWrap.port.Location),this.drawEdgeInteractivelyToPort(t.loosePolyline,this.DraggingStraightLine())):(this.viewer.RemoveTargetPortEdgeRouting(),this.DrawEdgeInteractivelyToLocation(e,this.DraggingStraightLine()))}e.preventDefault()}}MouseMoveLiveSelectObjectsForDragging(e){this.unselectEverything(),Ft(e)&&(this.viewer.modifierKeys&4)!=4&&this.SelectEntitiesForDraggingWithRectangle(e)}DrawEdgeInteractivelyToLocation(e,t){this.DrawEdgeInteractivelyToLocationP(this.viewer.screenToSource(e),t)}DrawEdgeInteractivelyToLocationP(e,t){this.geomEdge=t?this.getStraightLineEdge(e):this.CalculateEdgeInteractivelyToLocation(e),this.viewer.drawRubberEdge(this.geomEdge)}getStraightLineEdge(e){let t=new d.GeomEdge(null);return t.curve=d.LineSegment.mkPP(this.SourcePort.Location,e),t}CalculateEdgeInteractivelyToLocation(e){return this.interactiveEdgeRouter.SourcePort==null&&this.interactiveEdgeRouter.SetSourcePortAndSourceLoosePolyline(this.SourcePort,this.sourceLoosePolylineWrap.loosePolyline),this.interactiveEdgeRouter.RouteEdgeToLocation(e)}drawEdgeInteractivelyToPort(e,t){this.geomEdge=t?this.getStraightLineEdge(this.TargetPort.Location):this.CalculateEdgeInteractively(this.TargetPort,e),this.viewer.drawRubberEdge(this.geomEdge)}DraggingStraightLine(){return this.viewer.graph==null?!0:this.interactiveEdgeRouter!=null&&this.interactiveEdgeRouter.OverlapsDetected}CalculateEdgeInteractively(e,t){this.interactiveEdgeRouter.SourcePort==null&&this.interactiveEdgeRouter.SetSourcePortAndSourceLoosePolyline(this.SourcePort,this.sourceLoosePolylineWrap.loosePolyline);let r,s=null;if(this.SourceOfInsertedEdge==this.TargetOfInsertedEdge)r=d.LineSegment.mkPP(this.SourcePort.Location,this.TargetPort.Location);else{let a={smoothedPolyline:null};r=this.interactiveEdgeRouter.RouteEdgeToPort(e,t,!1,a),s=a.smoothedPolyline}let o=new d.GeomEdge(null);return o.curve=r,o.smoothedPolyline=s,o}};function Ft(n){return(n.buttons&1)==1}globalThis.msagl=globalThis.msagl||{};Object.assign(globalThis.msagl,Ue);})();
/*!
   Copyright 2019 Ron Buckton

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
*/
/*!
   Copyright 2021 Ron Buckton

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
*/
/*!
   Copyright 2022 Ron Buckton

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.

   THIRD PARTY LICENSE NOTICE:

   xxHash Library
   Copyright (c) 2012-2021 Yann Collet
   All rights reserved.

   BSD 2-Clause License (https://www.opensource.org/licenses/bsd-license.php)

   Redistribution and use in source and binary forms, with or without modification,
   are permitted provided that the following conditions are met:

   * Redistributions of source code must retain the above copyright notice, this
     list of conditions and the following disclaimer.

   * Redistributions in binary form must reproduce the above copyright notice, this
     list of conditions and the following disclaimer in the documentation and/or
     other materials provided with the distribution.

   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
   ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
   WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
   DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
   ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
   (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
   LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
   ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
/*!
   Copyright 2022 Ron Buckton

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
*/
/*! The following comments were added due to code inlined from "@esfx/internal-binarysearch": */
